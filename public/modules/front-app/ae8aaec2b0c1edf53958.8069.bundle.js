(self.webpackChunk=self.webpackChunk||[]).push([[8069],{18069:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>Kt});var i=n(22122),s=n(90484),a=n(96156),r=n(6610),o=n(5991),l=n(63349),c=n(10379),d=n(46070),u=n(77608),p=n(67294),h=n(69968),m=n(14494),v=n(15975),f=n(62309),g=n(9669),b=n.n(g),y=n(24294),E=(n(68593),n(14512),n(64367)),D=n(92137),w=n(87757),k=n.n(w),S=n(58965);const O=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={hasError:!1},t}return(0,o.Z)(s,[{key:"componentDidCatch",value:function(e,t){}},{key:"render",value:function(){return this.state.hasError?p.createElement("div",null,p.createElement("h1",{style:{textAlign:"center"}},"Ошибка отрисовки"),p.createElement("h4",null,"Измените настройки диаграммы и перезагрузите страницу")):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{hasError:!0}}}]),s}(p.Component);var Z=n(87329),x=n(40747),N=n(30381),P=n.n(N),R=100;const I=function(){function e(t,n,i,s,a){(0,r.Z)(this,e),this.diagramType=t,this.sources=n,this.storeParams=i,this.widgetParams=s,this.countRequest=a}var t,n,i,l,c;return(0,o.Z)(e,[{key:"getAlias",value:function(e){try{return e.split("altrpdata.")[1]}catch(e){console.log(e)}}},{key:"getDatasourceByPath",value:function(e){var t=this;return _.find(dataStorageUpdater.data.currentDataSources,(function(n){return n.data.alias===t.getAlias(e)}))}},{key:"queryString",value:function(e){var t=_.values(e).map((function(e,t){var n=encodeURIComponent(_.keys(e)[0]),i=encodeURIComponent(e[n]);return 0===t?null===e[n]||null==e[n]?"":"".concat(n,"=").concat(i):""===e[n]||null==e[n]?"":"&".concat(n,"=").concat(i)}));return t.join("")}},{key:"parseSourceParams",value:function(e){var t="";return void 0!==e&&(t=_.keys(e).map((function(t,n){if(void 0!==e[t]||""!==e[t])return"".concat(t,"=").concat(e[t])})).filter((function(e){var t="undefined"!==e.split("=")[1]?e.split("=")[1]:"";return void 0!==t&&""!==t&&null!==t&&"null"!==t})).join("&")),t}},{key:"selectFormatting",value:function(e,t,n,i){var s=[];switch(this.diagramType){case E.fq:case E.e_:case E.Fe:s=this.formatData(e,t,n,i);break;case E.en:s=this.formatDataPie(e,t,n,i);break;case E.u3:s=this.formatDataBar(e,t,n,i)}return s}},{key:"formatData",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.map((function(e){var s=_.get(e,t),a=P()(s).isValid()?P()(s).format("DD.MM.YYYY"):s;return{y:Number(_.get(e,n)),x:i?a:s}}))||[]}},{key:"formatDataPie",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.map((function(e){var s=_.get(e,t),a=P()(s).isValid()?P()(s).format("DD.MM.YYYY"):s;return{value:Number(_.get(e,n)),id:i?a:s}}))||[]}},{key:"formatDataBar",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return e.map((function(e){var s,r=_.get(e,t),o=P()(r).isValid()?P()(r).format("DD.MM.YYYY"):r;return s={key:i?o:r,value:Number(_.get(e,n))},(0,a.Z)(s,o,Number(_.get(e,n))),(0,a.Z)(s,"label",i?"".concat(o," (").concat(Number(_.get(e,n)),")"):"".concat(r," (").concat(Number(_.get(e,n)),")")),s}))||[]}},{key:"getDataWithParams",value:(c=(0,D.Z)(k().mark((function e(t,n,i,s,a){var r,o,l,c,d,u,p,h,m,v,f;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.path,o=n.title,l=n.keyIsDate,c=o||r,d=t.getWebUrl(),u=this.parseSourceParams(t.params),p=this.queryString(a)+"&"+u,p=Array.from(new Set(p.split("&"))).join("&"),h=d+"?"+p,e.prev=7,e.next=10,b()(h);case 10:return m=e.sent,v=void 0!==m.data.data?_.uniqBy(m.data.data,i):_.uniqBy(m.data,i),f=this.selectFormatting(v,i,s,l),n.splitTo&&n.splitFrom&&(f=f.slice(n.splitFrom,n.splitTo)),e.abrupt("return",{id:c,data:f});case 17:return e.prev=17,e.t0=e.catch(7),e.abrupt("return",[]);case 20:case"end":return e.stop()}}),e,this,[[7,17]])}))),function(e,t,n,i,s){return c.apply(this,arguments)})},{key:"adaptDataByPath",value:(l=(0,D.Z)(k().mark((function e(t){var n,i,s,a,r,o,l,c,d,u=arguments;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:{},i=t.path,s=t.key,a=t.data,r=t.title,o=t.keyIsDate,l=r||i,!(_.keys(n).length>0)){e.next=9;break}if(void 0===(c=this.getDatasourceByPath(i))){e.next=9;break}return e.next=8,this.getDataWithParams(c,t,s,a,n);case 8:return e.abrupt("return",e.sent);case 9:return e.prev=9,d=(0,x.getDataByPath)(i,[]),(d=Array.isArray(d)?d:[d]).length>0&&(d=_.uniqBy(d,s),d=this.selectFormatting(d,s,a,o),t.splitTo&&t.splitFrom&&(d=d.slice(t.splitFrom,t.splitTo))),e.abrupt("return",[{id:l,data:d}]);case 16:e.prev=16,e.t0=e.catch(9),console.log("ADAPTER ERROR =>",e.t0);case 19:case"end":return e.stop()}}),e,this,[[9,16]])}))),function(e){return l.apply(this,arguments)})},{key:"parseData",value:(i=(0,D.Z)(k().mark((function e(){var t,n,i,s,r,o,l,c,d,u,p,h,m;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n=_.keys(this.sources).length>1,i=!0,s=!0,r=!1,o=_.cloneDeep(this.storeParams,[]),l=_.keys(o).map((function(e){return(0,a.Z)({},e,o[e])})).filter((function(e){return""!==e[_.keys(e)[0]]})),c=_.cloneDeep(this.widgetParams,[]),d=void 0!==c&&"number"!=typeof c?c.concat(l):[].concat(l),!(_.keys(this.sources).length>0)){e.next=37;break}if(n){e.next=29;break}if(u=this.sources[0],e.prev=12,!(_.keys(d).length>0)){e.next=19;break}return e.next=16,this.adaptDataByPath(u,d);case 16:t=e.sent,e.next=22;break;case 19:return e.next=21,this.adaptDataByPath(u);case 21:t=e.sent;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),t=[];case 27:e.next=33;break;case 29:return e.next=31,this.getDataFromIterableDatasources(this.sources,d);case 31:(t=e.sent).forEach((function(e,n){t[n]=e[0]}));case 33:return p=[],h=[],n?(m=t.map((function(e){return _.keys(e).length>0?(r||(r=void 0!==e.data&&e.data.length>R),void 0!==e.data&&e.data.length>R):_.keys(e).length>0})),(i=_.includes(m,!1))||((p=t.map((function(e){return e.data.map((function(e){return e.key instanceof Date}))}))).forEach((function(e){return h=h.concat(e)})),h=_.uniq(h),s=!0!==_.includes(h,!1))):(Array.isArray(t)||(t=[t]),i=void 0===t[0]||0===_.keys(t[0].data).length&&this.countRequest<5,p=t.map((function(e){return r||(r=e.data.length>R),e.key instanceof Date})),p=_.uniq(p),s=!0!==_.includes(p,!1)),e.abrupt("return",{data:t,isMultiple:n,isDate:s,needCallAgain:i,isLarge:r});case 37:return e.abrupt("return",{data:[],isMultiple:n,isDate:s,needCallAgain:i,isLarge:r});case 38:case"end":return e.stop()}}),e,this,[[12,24]])}))),function(){return i.apply(this,arguments)})},{key:"parseDataNotType",value:(n=(0,D.Z)(k().mark((function e(){var t,n,i,r,o,l,c,d,u,p,h,m,v,f,g,b;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],n=_.keys(this.sources).length>1,i=!0,r=!0,o=!1,l=_.cloneDeep(this.storeParams,[]),c=_.keys(l).map((function(e){return(0,a.Z)({},e,l[e])})).filter((function(e){return""!==e[_.keys(e)[0]]})),d=_.cloneDeep(this.widgetParams,[]),u=void 0!==d&&"number"!=typeof d?d.concat(c):[].concat(c),!(_.keys(this.sources).length>0)){e.next=33;break}if(n){e.next=24;break}if(p=this.sources[0],!(_.keys(u).length>0)){e.next=18;break}return e.next=15,this.adaptDataByPath(p,u);case 15:t=e.sent,e.next=21;break;case 18:return e.next=20,this.adaptDataByPath(p);case 20:t=e.sent;case 21:t="object"===(0,s.Z)(t)&&0===_.keys(t)?[]:t,e.next=28;break;case 24:return e.next=26,this.getDataFromIterableDatasources(this.sources,u);case 26:(t=e.sent).forEach((function(e,n){t[n]=e[0]}));case 28:return h=[],m=[],n?(v=t.map((function(e){return _.keys(e).length>0?(o||(o=e.length>R),e.length>0):_.keys(e).length>0})),(i=_.includes(v,!1))||((h=t.map((function(e){return e.map((function(e){return e.key instanceof Date}))}))).forEach((function(e){return m=m.concat(e)})),m=_.uniq(m),r=!0!==_.includes(m,!1))):(f=t.length>0?t.map((function(e){return e.length>0})):[!1],i=_.includes(f,!1)&&this.countRequest<5,h=t.length>0&&t.map((function(e){return o||(o=e.length>R),e.key instanceof Date})),h=_.uniq(h),r=!0!==_.includes(h,!1)),this.diagramType===E.en?t=Array.isArray(t)?_.uniqBy((g=[]).concat.apply(g,(0,Z.Z)(t.map((function(e){return e.data})))),"id"):t.data.length>0?_.uniqBy(t.data,"id"):[]:n||this.diagramType!==E.u3?t=(b=[]).concat.apply(b,(0,Z.Z)(t.map((function(e){return e.data})))):n||this.diagramType!==E.u3||(t=Array.isArray(t)?t[0].data:t.data),e.abrupt("return",{data:t,isMultiple:n,isDate:r,needCallAgain:i,isLarge:o});case 33:return e.abrupt("return",{data:[],isMultiple:n,isDate:r,needCallAgain:i,isLarge:o});case 34:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getDataFromIterableDatasources",value:(t=(0,D.Z)(k().mark((function e(t){var n,i=this,s=arguments;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=s.length>1&&void 0!==s[1]?s[1]:{},e.abrupt("return",Promise.all(t.map(function(){var e=(0,D.Z)(k().mark((function e(t){var s;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=[],!(_.keys(n).length>0)){e.next=7;break}return e.next=4,i.adaptDataByPath(t,n);case 4:s=e.sent,e.next=10;break;case 7:return e.next=9,i.adaptDataByPath(t);case 9:s=e.sent;case 10:if(0!==_.keys(s).length){e.next=12;break}return e.abrupt("return",[]);case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();var L=n(17253),j=n.n(L),C=n(22683),A=n(23233);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=_.find(A.Z,{value:"regagro"}).colors.reverse(),T=function(e){(0,c.Z)(h,e);var t,n,i,s,a,l=(s=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(s);if(a){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=l.call(this,e)).state={settings:_.cloneDeep(e.element.settings),sources:_.cloneDeep(e.sources),legend:_.cloneDeep(e.element.settings.legend),color:_.cloneDeep(e.element.settings.color),params:_.cloneDeep(e.element.settings.params),countRequest:0,isMultiple:!1,isDate:!0,isLarge:!1,data:[]},t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:(i=(0,D.Z)(k().mark((function e(t,n){var i=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isEqual(t.sources,this.props.sources)){e.next=4;break}return this.setState((function(e){return W(W({},e),{},{sources:i.props.sources})})),e.next=4,this.getData();case 4:if(_.isEqual(t.element,this.props.element)||this.setState((function(e){return W(W({},e),{},{legend:i.props.element.settings.legend,color:i.props.element.settings.color,sources:i.props.element.settings.sources})})),_.isEqual(t.element.settings.params,this.props.element.settings.params)){e.next=9;break}return this.setState((function(e){return W(W({},e),{},{params:i.props.element.settings.params})})),e.next=9,this.getData();case 9:if(_.isEqual(t.element.settings,this.props.element.settings)||this.setState((function(e){return W(W({},e),{},{settings:i.props.element.settings})})),JSON.stringify(t.element.settings.params)===JSON.stringify(this.props.element.settings.params)){e.next=14;break}return this.setState((function(e){return W(W({},e),{},{params:i.props.element.settings.params})})),e.next=14,this.getData();case 14:if(_.isEqual(t.formsStore.form_data,this.props.formsStore.form_data)){e.next=18;break}return this.setState((function(e){return W(W({},e),{},{countRequest:0})})),e.next=18,this.getData();case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"componentDidMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getData",value:(t=(0,D.Z)(k().mark((function e(){var t,n,i,s,a,r,o=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new I(this.props.element.settings.type,this.props.element.settings.sources,_.cloneDeep(this.props.formsStore.form_data),this.state.params,this.state.countRequest).parseDataNotType();case 2:t=e.sent,n=t.isMultiple,i=t.isDate,s=t.isLarge,a=t.needCallAgain,r=t.data,a&&setTimeout((function(){o.getData();var e=o.state.countRequest;e+=1,o.setState((function(t){return W(W({},t),{},{countRequest:e})}))}),3500),this.setState((function(e){return W(W({},e),{},{data:r,isMultiple:n,isDate:i,isLarge:s})}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e=this;if(void 0===this.state.sources)return p.createElement("div",null,"Укажите источник данных");if(null===this.state.sources&&0===Object.keys(this.state.sources).length)return p.createElement("div",null,"Нет данных");if(this.state.isLarge)return p.createElement("div",null,"Ограничьте диапозон данных или выберите другой источник");if(void 0!==this.state.data&&this.state.data.length>0){var t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,E,D,w,k,Z,x,N,P,R,I,L,A,z,T,B,F,Y,H,V,M,X,J,G,U,$,K,Q,ee,te,ne=this.state.data;switch(null===(t=this.state.settings)||void 0===t||null===(n=t.sort)||void 0===n?void 0:n.value){case"value":ne=_.sortBy(ne,["value"]);break;case"key":ne=_.sortBy(ne,["key"]);break;default:ne=ne}return p.createElement(p.Fragment,null,p.createElement(O,null,p.createElement(S.dc,{data:ne,indexBy:"key",enableLabel:null===(i=this.state.settings)||void 0===i?void 0:i.enableSliceLabels,padding:null===(s=this.state.settings)||void 0===s?void 0:s.padding,innerPadding:null===(a=this.state.settings)||void 0===a?void 0:a.innerPadding,reverse:null===(r=this.state.settings)||void 0===r?void 0:r.reverse,groupMode:null===(o=this.state.settings)||void 0===o?void 0:o.groupMode,layout:null===(l=this.state.settings)||void 0===l?void 0:l.layout,labelSkipHeight:null===(c=this.state.settings)||void 0===c?void 0:c.labelSkipHeight,labelSkipWidth:null===(d=this.state.settings)||void 0===d?void 0:d.labelSkipWidth,enableGridY:null===(u=this.state.settings)||void 0===u?void 0:u.enableGridY,enableGridX:null===(h=this.state.settings)||void 0===h?void 0:h.enableGridX,labelTextColor:function(e){return j()(e.color,{black:"#000000",white:"#FFFFFF",threshold:.45})},theme:{tooltip:{container:{padding:"0"}}},margin:{top:(null===(m=this.state.settings)||void 0===m||null===(v=m.margin)||void 0===v?void 0:v.top)||40,right:(null===(f=this.state.settings)||void 0===f||null===(g=f.margin)||void 0===g?void 0:g.right)||80,bottom:(null===(b=this.state.settings)||void 0===b||null===(y=b.margin)||void 0===y?void 0:y.bottom)||80,left:(null===(E=this.state.settings)||void 0===E||null===(D=E.margin)||void 0===D?void 0:D.left)||80},colors:"regagro"===(null===(w=this.state.settings)||void 0===w||null===(k=w.colors)||void 0===k?void 0:k.scheme)?q:null===(Z=this.state.settings)||void 0===Z?void 0:Z.colors,colorBy:"index",tooltip:function(t){var n;return p.createElement(C.Z,{enable:null===(n=e.state.settings)||void 0===n?void 0:n.enableCustomTooltip,datum:t,widgetID:e.props.widgetID})},axisLeft:"horizontal"===(null===(x=this.state.settings)||void 0===x?void 0:x.layout)?!(null!==(N=this.state.settings)&&void 0!==N&&N.reverse)&&{tickRotation:0}:{tickRotation:0},axisRight:"horizontal"===(null===(P=this.state.settings)||void 0===P?void 0:P.layout)?(null===(R=this.state.settings)||void 0===R?void 0:R.reverse)&&{tickRotation:0}:null,axisBottom:"vertical"===(null===(I=this.state.settings)||void 0===I?void 0:I.layout)?!(null!==(L=this.state.settings)&&void 0!==L&&L.reverse)&&W({},null===(A=this.state.settings)||void 0===A?void 0:A.axisBottom):W({},null===(z=this.state.settings)||void 0===z?void 0:z.axisBottom),axisTop:"vertical"===(null===(T=this.state.settings)||void 0===T?void 0:T.layout)?(null===(B=this.state.settings)||void 0===B?void 0:B.reverse)&&W({},null===(F=this.state.settings)||void 0===F?void 0:F.axisBottom):null,animate:!1,motionDamping:null===(Y=this.state.settings)||void 0===Y?void 0:Y.animationMotionDamping,motionStiffness:null===(H=this.state.settings)||void 0===H?void 0:H.animationMotionStiffness,legends:null!==(V=this.state.settings)&&void 0!==V&&V.enableLegend?[{dataFrom:"indexes",anchor:(null===(M=this.state.settings)||void 0===M?void 0:M.legendAchor)||"bottom-right",direction:(null===(X=this.state.settings)||void 0===X?void 0:X.legendDirection)||"row",justify:(null===(J=this.state.settings)||void 0===J?void 0:J.legendJustify)||!1,translateX:(null===(G=this.state.settings)||void 0===G?void 0:G.legendTranslateX)||0,translateY:(null===(U=this.state.settings)||void 0===U?void 0:U.legendTranslateY)||0,itemsSpacing:(null===($=this.state.settings)||void 0===$?void 0:$.legendItemsSpacing)||10,itemWidth:(null===(K=this.state.settings)||void 0===K?void 0:K.legendItemWidth)||10,itemHeight:(null===(Q=this.state.settings)||void 0===Q?void 0:Q.legendItemHeight)||10,itemDirection:(null===(ee=this.state.settings)||void 0===ee?void 0:ee.legendItemDirection)||"left-to-right",symbolSize:(null===(te=this.state.settings)||void 0===te?void 0:te.legendSymbolSize)||25,symbolShape:"circle"}]:[]})))}return this.state.countRequest<5?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}}]),h}(p.Component);const B=(0,m.$j)((function(e){return{formsStore:_.cloneDeep(e.formsStore)}}))(T);var F=n(73445),Y=n(33695);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var M=_.find(A.Z,{value:"regagro"}).colors.reverse(),X=function(e){(0,c.Z)(h,e);var t,n,i,s,a,l=(s=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(s);if(a){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=l.call(this,e)).state={settings:_.cloneDeep(e.element.settings),sources:_.cloneDeep(e.sources),legend:_.cloneDeep(e.element.settings.legend),color:_.cloneDeep(e.element.settings.color),params:_.cloneDeep(e.element.settings.params),countRequest:0,isDate:!0,data:[]},t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:(i=(0,D.Z)(k().mark((function e(t,n){var i=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isEqual(t.sources,this.props.sources)){e.next=4;break}return this.setState((function(e){return V(V({},e),{},{sources:i.props.sources})})),e.next=4,this.getData();case 4:if(_.isEqual(t.element,this.props.element)||this.setState((function(e){return V(V({},e),{},{legend:i.props.element.settings.legend,color:i.props.element.settings.color,sources:i.props.element.settings.sources})})),_.isEqual(t.element.settings.params,this.props.element.settings.params)){e.next=9;break}return this.setState((function(e){return V(V({},e),{},{params:i.props.element.settings.params})})),e.next=9,this.getData();case 9:if(_.isEqual(t.element.settings,this.props.element.settings)||this.setState((function(e){return V(V({},e),{},{settings:i.props.element.settings})})),JSON.stringify(t.element.settings.params)===JSON.stringify(this.props.element.settings.params)){e.next=14;break}return this.setState((function(e){return V(V({},e),{},{params:i.props.element.settings.params})})),e.next=14,this.getData();case 14:if(_.isEqual(t.formsStore.form_data,this.props.formsStore.form_data)){e.next=18;break}return this.setState((function(e){return V(V({},e),{},{countRequest:0})})),e.next=18,this.getData();case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"componentDidMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getData",value:(t=(0,D.Z)(k().mark((function e(){var t,n,i,s,a,r=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new I(this.props.element.settings.type,this.props.element.settings.sources,_.cloneDeep(this.props.formsStore.form_data),this.state.params,this.state.countRequest).parseDataNotType();case 2:t=e.sent,n=t.isMultiple,i=t.isDate,s=t.needCallAgain,a=t.data,s&&setTimeout((function(){r.getData();var e=r.state.countRequest;e+=1,r.setState((function(t){return V(V({},t),{},{countRequest:e})}))}),3500),this.setState((function(e){return V(V({},e),{},{data:a,isMultiple:n,isDate:i})}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,E,D,w,k,S,Z,x,N,P,R,I,L,C,A,z,W,q,T,B,H,V,X,J=this;if(void 0===this.state.sources)return p.createElement("div",null,"Укажите источник данных");if(0===Object.keys(this.state.sources).length)return p.createElement("div",null,"Нет данных ");if(void 0!==this.state.data&&0===this.state.data.length)return this.state.countRequest<3?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных");var G,U,$=this.state.data;if(null!==(null===(e=this.state.settings)||void 0===e||null===(t=e.sort)||void 0===t?void 0:t.value)&&void 0!==(null===(n=this.state.settings)||void 0===n||null===(i=n.sort)||void 0===i?void 0:i.value)&&void 0!==$)switch(null===(G=this.state.settings)||void 0===G||null===(U=G.sort)||void 0===U?void 0:U.value){case"value":$=_.sortBy($,["value"]);break;case"key":$=_.sortBy($,["id"]);break;default:$=$}return p.createElement(p.Fragment,null,p.createElement(O,null,p.createElement(F.Y2,{margin:{top:(null===(s=this.state.settings)||void 0===s||null===(a=s.margin)||void 0===a?void 0:a.top)||80,right:(null===(r=this.state.settings)||void 0===r||null===(o=r.margin)||void 0===o?void 0:o.right)||180,bottom:(null===(l=this.state.settings)||void 0===l||null===(c=l.margin)||void 0===c?void 0:c.bottom)||80,left:(null===(d=this.state.settings)||void 0===d||null===(u=d.margin)||void 0===u?void 0:u.left)||120},sliceLabelsTextColor:function(e){return j()(e.color,{black:"#000000",white:"#FFFFFF",threshold:.45})},cornerRadius:null===(h=this.state.settings)||void 0===h?void 0:h.cornerRadius,padAngle:null===(m=this.state.settings)||void 0===m?void 0:m.padAngle,borderWidth:null===(v=this.state.settings)||void 0===v?void 0:v.borderWidth,borderColor:null===(f=this.state.settings)||void 0===f?void 0:f.borderColor,data:$,colors:"regagro"===(null===(g=this.state.settings)||void 0===g||null===(b=g.colors)||void 0===b?void 0:b.scheme)?M:null===(y=this.state.settings)||void 0===y?void 0:y.colors,sliceLabelsSkipAngle:null===(E=this.state.settings)||void 0===E?void 0:E.sliceLabelsSkipAngle,sliceLabelsRadiusOffset:null===(D=this.state.settings)||void 0===D?void 0:D.sliceLabelsRadiusOffset,radialLabelsSkipAngle:null===(w=this.state.settings)||void 0===w?void 0:w.radialLabelsSkipAngle,radialLabelsLinkOffset:null===(k=this.state.settings)||void 0===k?void 0:k.radialLabelsLinkOffset,radialLabelsLinkDiagonalLength:null===(S=this.state.settings)||void 0===S?void 0:S.radialLabelsLinkDiagonalLength,radialLabelsLinkHorizontalLength:null===(Z=this.state.settings)||void 0===Z?void 0:Z.radialLabelsLinkHorizontalLength,radialLabelsTextXOffset:null===(x=this.state.settings)||void 0===x?void 0:x.radialLabelsTextXOffset,radialLabelsLinkStrokeWidth:null===(N=this.state.settings)||void 0===N?void 0:N.radialLabelsLinkStrokeWidth,innerRadius:null===(P=this.state.settings)||void 0===P?void 0:P.innerRadius,enableSliceLabels:null===(R=this.state.settings)||void 0===R?void 0:R.enableSliceLabels,enableRadialLabels:null===(I=this.state.settings)||void 0===I?void 0:I.enableRadialLabels,tooltip:function(e){var t;return p.createElement(Y.Z,{enable:null===(t=J.state.settings)||void 0===t?void 0:t.enableCustomTooltip,datum:e,widgetID:J.props.widgetID})},legends:null!==(L=this.state.settings)&&void 0!==L&&L.enableLegend?[{anchor:(null===(C=this.state.settings)||void 0===C?void 0:C.legendAchor)||"bottom-right",direction:(null===(A=this.state.settings)||void 0===A?void 0:A.legendDirection)||"row",justify:(null===(z=this.state.settings)||void 0===z?void 0:z.legendJustify)||!1,translateX:(null===(W=this.state.settings)||void 0===W?void 0:W.legendTranslateX)||0,translateY:(null===(q=this.state.settings)||void 0===q?void 0:q.legendTranslateY)||0,itemsSpacing:(null===(T=this.state.settings)||void 0===T?void 0:T.legendItemsSpacing)||10,itemWidth:(null===(B=this.state.settings)||void 0===B?void 0:B.legendItemWidth)||10,itemHeight:(null===(H=this.state.settings)||void 0===H?void 0:H.legendItemHeight)||10,itemDirection:(null===(V=this.state.settings)||void 0===V?void 0:V.legendItemDirection)||"left-to-right",symbolSize:(null===(X=this.state.settings)||void 0===X?void 0:X.legendSymbolSize)||25,symbolShape:"circle"}]:[]})))}}]),h}(p.Component);const J=(0,m.$j)((function(e){return{formsStore:_.cloneDeep(e.formsStore)}}))(X);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){(0,c.Z)(h,e);var t,n,i,s,a,l=(s=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(s);if(a){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=l.call(this,e)).state={sources:_.cloneDeep(e.sources),color:_.cloneDeep(e.element.settings.color),params:_.cloneDeep(e.element.settings.params),countRequest:0,isMultiple:!1,data:[]},t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:(i=(0,D.Z)(k().mark((function e(t,n){var i=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isEqual(t.sources,this.props.sources)){e.next=4;break}return this.setState((function(e){return U(U({},e),{},{sources:_.cloneDeep(i.props.sources)})})),e.next=4,this.getData();case 4:if(_.isEqual(t.element,this.props.element)||this.setState((function(e){return U(U({},e),{},{legend:_.cloneDeep(i.props.element.settings.legend),color:_.cloneDeep(i.props.element.settings.color),sources:_.cloneDeep(i.props.element.settings.sources)})})),_.isEqual(t.element.settings.params,this.props.element.settings.params)){e.next=9;break}return this.setState((function(e){return U(U({},e),{},{params:_.cloneDeep(i.props.element.settings.params)})})),e.next=9,this.getData();case 9:if(_.isEqual(t.element.settings,this.props.element.settings)||this.setState((function(e){return U(U({},e),{},{settings:_.cloneDeep(i.props.element.settings)})})),JSON.stringify(t.element.settings.params)===JSON.stringify(this.props.element.settings.params)){e.next=14;break}return this.setState((function(e){return U(U({},e),{},{params:_.cloneDeep(i.props.element.settings.params)})})),e.next=14,this.getData();case 14:if(_.isEqual(t.formsStore.form_data,this.props.formsStore.form_data)){e.next=18;break}return this.setState((function(e){return U(U({},e),{},{countRequest:0})})),e.next=18,this.getData();case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"componentDidMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getData",value:(t=(0,D.Z)(k().mark((function e(){var t,n,i,s,a,r,o=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new I(this.props.element.settings.type,this.props.element.settings.sources,_.cloneDeep(this.props.formsStore.form_data),this.state.params,this.state.countRequest).parseData();case 2:t=e.sent,n=t.data,i=t.isMultiple,s=t.isDate,a=t.needCallAgain,r=t.isLarge,a&&setTimeout((function(){o.getData();var e=o.state.countRequest;e+=1,o.setState((function(t){return U(U({},t),{},{countRequest:e})}))}),5e3),this.setState((function(e){return U(U({},e),{},{data:n,isMultiple:i,isDate:s,isLarge:r})}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sum",value:function(e){return e.reduce((function(e,t){return e+t.data}),0)}},{key:"render",value:function(){var e,t,n,i,s=this;if(void 0===this.state.sources||0===Object.keys(this.state.sources).length)return p.createElement("div",null,"Нет данных ");if(!this.state.sources>1){if(void 0===this.state.data&&0===this.state.data[0].data.length)return this.state.countRequest<3?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}else{var a=this.state.data.map((function(e){return _.keys(e).length>0?e.data.length>0:_.keys(e).length>0}));if(_.includes(a,!1))return this.state.countRequest<3?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}var r,o=this.state.data;if(null!==(null===(e=this.state.settings)||void 0===e||null===(t=e.sort)||void 0===t?void 0:t.value)&&void 0!==(null===(n=this.state.settings)||void 0===n||null===(i=n.sort)||void 0===i?void 0:i.value)&&void 0!==o)switch(null===(r=this.state.settings)||void 0===r?void 0:r.sort.value){case"value":o.forEach((function(e,t){e.data.length>0&&(o[t].data=_.sortBy(e.data,["y"]))}));break;case"key":o.forEach((function(e,t){e.data.length>0&&(o[t].data=_.sortBy(e.data,["x"]))}))}var l=o.map((function(e){return e.data.reduce((function(e,t){return e+t.y}),0)})).reduce((function(e,t){return e+t}),0);return p.createElement(O,null,p.createElement("div",{className:"widget-table"},p.createElement("table",{className:"vertical-table"},p.createElement("tbody",null,o.map((function(e,t){var n=e.data.map((function(e,n){return p.createElement("tr",{key:"".concat(t).concat(n)},p.createElement("td",null,e.key instanceof Date?s.formattingDate(e.x):e.x),p.createElement("td",null,e.y))}));return p.createElement(p.Fragment,{key:t},p.createElement("tr",{key:t,style:{textAlign:"center"}},p.createElement("td",{colSpan:2},e.id)),n)})),p.createElement("tr",null,p.createElement("td",null,"ИТОГО"),p.createElement("td",null,l))))))}}]),h}(p.Component);const K=(0,m.$j)((function(e){return{formsStore:_.cloneDeep(e.formsStore)}}))($);var Q=n(24549),ee=n(40173),te=n(45250);function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var se=_.find(A.Z,{value:"regagro"}).colors,ae=function(e){(0,c.Z)(h,e);var t,n,i,s,a,l=(s=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(s);if(a){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=l.call(this,e)).state={settings:_.cloneDeep(e.element.settings),sources:_.cloneDeep(e.sources),legend:_.cloneDeep(e.element.settings.legend),color:_.cloneDeep(e.element.settings.color),params:_.cloneDeep(e.element.settings.params),countRequest:0,isMultiple:!1,isDate:!0,isLarge:!1,data:[]},t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:(i=(0,D.Z)(k().mark((function e(t,n){var i=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isEqual(t.sources,this.props.sources)){e.next=4;break}return this.setState((function(e){return ie(ie({},e),{},{sources:_.cloneDeep(i.props.sources)})})),e.next=4,this.getData();case 4:if(_.isEqual(t.element,this.props.element)||this.setState((function(e){return ie(ie({},e),{},{legend:i.props.element.settings.legend,color:i.props.element.settings.color,sources:i.props.element.settings.sources})})),_.isEqual(t.element.settings.params,this.props.element.settings.params)){e.next=9;break}return this.setState((function(e){return ie(ie({},e),{},{params:_.cloneDeep(i.props.element.settings.params)})})),e.next=9,this.getData();case 9:if(_.isEqual(t.element.settings,this.props.element.settings)||this.setState((function(e){return ie(ie({},e),{},{settings:i.props.element.settings})})),JSON.stringify(t.element.settings.params)===JSON.stringify(this.props.element.settings.params)){e.next=14;break}return this.setState((function(e){return ie(ie({},e),{},{params:_.cloneDeep(i.props.element.settings.params)})})),e.next=14,this.getData();case 14:if(_.isEqual(t.formsStore.form_data,this.props.formsStore.form_data)&&JSON.stringify(t.formsStore.form_data)===JSON.stringify(this.props.formsStore.form_data)){e.next=18;break}return this.setState((function(e){return ie(ie({},e),{},{countRequest:0})})),e.next=18,this.getData();case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"componentDidMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getData",value:(t=(0,D.Z)(k().mark((function e(){var t,n,i,s,a,r,o=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new I(this.props.element.settings.type,this.props.element.settings.sources,_.cloneDeep(this.props.formsStore.form_data),this.state.params,this.state.countRequest).parseData();case 2:t=e.sent,n=t.isMultiple,i=t.isDate,s=t.needCallAgain,a=t.isLarge,r=t.data,s&&setTimeout((function(){o.getData();var e=o.state.countRequest;e+=1,o.setState((function(t){return ie(ie({},t),{},{countRequest:e})}))}),3500),this.setState((function(e){return ie(ie({},e),{},{data:r,isMultiple:n,isDate:i,isLarge:a})}));case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,E,D,w,k,S,Z,x,N,R,I,L,j,C,A,z,W,q,T,B,F,Y,H,V,M,X,J,G,U=this;if(void 0===this.state.sources)return p.createElement("div",null,"Укажите источник данных");if(0===Object.keys(this.state.sources).length)return p.createElement("div",null,"Нет данных ");if(!this.state.sources>1){if(void 0===this.state.data&&0===this.state.data[0].data.length)return this.state.countRequest<3?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}else{var $=this.state.data.map((function(e){return _.keys(e).length>0?e.data.length>0:_.keys(e).length>0}));if(_.includes($,!1))return this.state.countRequest<5?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}var K,ne,ae=[];if(ae="time"===(null===(e=this.state.settings)||void 0===e||null===(t=e.xScale)||void 0===t?void 0:t.type)?(ae=_.cloneDeep(this.state.data,[])).map((function(e){return e.data=e.data.map((function(e){return e.x=P()(e.x).format("DD.MM.YYYY"),e})),e})):this.state.data,null!==(null===(n=this.state.settings)||void 0===n||null===(i=n.sort)||void 0===i?void 0:i.value)&&void 0!==(null===(s=this.state.settings)||void 0===s||null===(a=s.sort)||void 0===a?void 0:a.value)&&void 0!==ae)switch(null===(K=this.state.settings)||void 0===K||null===(ne=K.sort)||void 0===ne?void 0:ne.value){case"value":ae.forEach((function(e,t){e.data.length>0&&(ae[t].data=_.sortBy(e.data,["y"]))}));break;case"key":ae.forEach((function(e,t){e.data.length>0&&(ae[t].data=_.sortBy(e.data,["x"]))}))}return p.createElement(p.Fragment,null,p.createElement(O,null,p.createElement(Q.fH,{data:ae,margin:{top:(null===(r=this.state.settings)||void 0===r||null===(o=r.margin)||void 0===o?void 0:o.top)||40,right:(null===(l=this.state.settings)||void 0===l||null===(c=l.margin)||void 0===c?void 0:c.right)||120,bottom:(null===(d=this.state.settings)||void 0===d||null===(u=d.margin)||void 0===u?void 0:u.bottom)||80,left:(null===(h=this.state.settings)||void 0===h||null===(m=h.margin)||void 0===m?void 0:m.left)||100},curve:null===(v=this.state.settings)||void 0===v?void 0:v.curve,colors:"regagro"===(null===(f=this.state.settings)||void 0===f||null===(g=f.colors)||void 0===g?void 0:g.scheme)?se:null===(b=this.state.settings)||void 0===b?void 0:b.colors,enableArea:null===(y=this.state.settings)||void 0===y?void 0:y.enableArea,defs:(null===(E=this.state.settings)||void 0===E?void 0:E.enableArea)&&[(0,ee.c$)("gradient",[{offset:0,color:"inherit"},{offset:100,color:"inherit",opacity:.25}])],fill:(null===(D=this.state.settings)||void 0===D?void 0:D.enableArea)&&[{match:"*",id:"gradient"}],useMesh:!0,xScale:null===(w=this.state.settings)||void 0===w?void 0:w.xScale,pointSize:null===(k=this.state.settings)||void 0===k?void 0:k.pointSize,enablePoints:null===(S=this.state.settings)||void 0===S?void 0:S.enablePoints,lineWidth:null===(Z=this.state.settings)||void 0===Z?void 0:Z.lineWidth,enableCrosshair:null===(x=this.state.settings)||void 0===x?void 0:x.enableCrosshair,enableGridY:null===(N=this.state.settings)||void 0===N?void 0:N.enableGridY,enableGridX:null===(R=this.state.settings)||void 0===R?void 0:R.enableGridX,xFormat:"time"===(null===(I=this.state.settings)||void 0===I||null===(L=I.xScale)||void 0===L?void 0:L.type)&&"time:%d.%m.%Y",axisBottom:"time"===(null===(j=this.state.settings)||void 0===j||null===(C=j.xScale)||void 0===C?void 0:C.type)?ie({format:this.state.settings.xScale.format},null===(A=this.state.settings)||void 0===A?void 0:A.axisBottom):ie({},null===(z=this.state.settings)||void 0===z?void 0:z.axisBottom),tooltip:function(e){var t,n;return p.createElement(te.Z,{datum:e,settings:{padding:null===(t=U.state.settings)||void 0===t?void 0:t.tooltipPadding},enable:null===(n=U.state.settings)||void 0===n?void 0:n.enableCustomTooltip,widgetID:U.props.widgetID})},animate:Boolean(null===(W=this.state.settings)||void 0===W?void 0:W.enableAnimation),legends:null!==(q=this.state.settings)&&void 0!==q&&q.enableLegend?[{anchor:(null===(T=this.state.settings)||void 0===T?void 0:T.legendAchor)||"bottom-right",direction:(null===(B=this.state.settings)||void 0===B?void 0:B.legendDirection)||"row",justify:(null===(F=this.state.settings)||void 0===F?void 0:F.legendJustify)||!1,translateX:(null===(Y=this.state.settings)||void 0===Y?void 0:Y.legendTranslateX)||0,translateY:(null===(H=this.state.settings)||void 0===H?void 0:H.legendTranslateY)||0,itemsSpacing:(null===(V=this.state.settings)||void 0===V?void 0:V.legendItemsSpacing)||10,itemWidth:(null===(M=this.state.settings)||void 0===M?void 0:M.legendItemWidth)||10,itemHeight:(null===(X=this.state.settings)||void 0===X?void 0:X.legendItemHeight)||10,itemDirection:(null===(J=this.state.settings)||void 0===J?void 0:J.legendItemDirection)||"left-to-right",symbolSize:(null===(G=this.state.settings)||void 0===G?void 0:G.legendSymbolSize)||25,symbolShape:"circle"}]:[]})))}}]),h}(p.Component);const re=(0,m.$j)((function(e){return{formsStore:_.cloneDeep(e.formsStore)}}))(ae);var oe=n(33125),le=n(59533);function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=_.find(A.Z,{value:"regagro"}).colors,pe=function(e){(0,c.Z)(h,e);var t,n,i,s,a,l=(s=h,a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(s);if(a){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=l.call(this,e)).state={settings:_.cloneDeep(e.element.settings),sources:_.cloneDeep(e.sources),legend:_.cloneDeep(e.element.settings.legend),color:_.cloneDeep(e.element.settings.color),params:_.cloneDeep(e.element.settings.params),countRequest:0,isDate:!0,data:[]},t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:(i=(0,D.Z)(k().mark((function e(t,n){var i=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.isEqual(t.sources,this.props.sources)){e.next=4;break}return this.setState((function(e){return de(de({},e),{},{sources:i.props.sources})})),e.next=4,this.getData();case 4:if(_.isEqual(t.element,this.props.element)||this.setState((function(e){return de(de({},e),{},{legend:i.props.element.settings.legend,color:i.props.element.settings.color,sources:i.props.element.settings.sources})})),_.isEqual(t.element.settings.params,this.props.element.settings.params)){e.next=9;break}return this.setState((function(e){return de(de({},e),{},{params:i.props.element.settings.params})})),e.next=9,this.getData();case 9:if(_.isEqual(t.element.settings,this.props.element.settings)||this.setState((function(e){return de(de({},e),{},{settings:i.props.element.settings})})),JSON.stringify(t.element.settings.params)===JSON.stringify(this.props.element.settings.params)){e.next=14;break}return this.setState((function(e){return de(de({},e),{},{params:i.props.element.settings.params})})),e.next=14,this.getData();case 14:if(_.isEqual(t.formsStore.form_data,this.props.formsStore.form_data)){e.next=18;break}return this.setState((function(e){return de(de({},e),{},{countRequest:0})})),e.next=18,this.getData();case 18:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"componentDidMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getData();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getData",value:(t=(0,D.Z)(k().mark((function e(){var t,n,i,s,a,r,o=this;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new I(this.props.element.settings.type,this.props.element.settings.sources,_.cloneDeep(this.props.formsStore.form_data),this.state.params,this.state.countRequest).parseData();case 2:t=e.sent,n=t.data,i=t.isMultiple,s=t.isDate,a=t.needCallAgain,r=t.isLarge,a&&setTimeout((function(){o.getData();var e=o.state.countRequest;e+=1,o.setState((function(t){return de(de({},t),{},{countRequest:e})}))}),3500),this.setState((function(e){return de(de({},e),{},{data:n,isMultiple:i,isDate:s,isLarge:r})}));case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,E,D,w,k,S,Z,x,N,R,I,L,j,C,A,z,W,q,T,B,F,Y,H=this;if(void 0===this.state.sources)return p.createElement("div",null,"Укажите источник данных");if(0===Object.keys(this.state.sources).length)return p.createElement("div",null,"Нет данных ");if(!this.state.sources>1){if(void 0===this.state.data&&0===this.state.data[0].data.length)return this.state.countRequest<3?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}else{var V=this.state.data.map((function(e){return _.keys(e).length>0?e.data.length>0:_.keys(e).length>0}));if(_.includes(V,!1))return this.state.countRequest<5?p.createElement("div",null,"Загрузка..."):p.createElement("div",null,"Нет данных")}var M,X,J=[];if(J="time"===(null===(e=this.state.settings)||void 0===e||null===(t=e.xScale)||void 0===t?void 0:t.type)?(J=_.cloneDeep(this.state.data,[])).map((function(e){return e.data=e.data.map((function(e){return e.x=P()(e.x).format("DD.MM.YYYY"),e})),e})):this.state.data,null!==(null===(n=this.state.settings)||void 0===n||null===(i=n.sort)||void 0===i?void 0:i.value)&&void 0!==(null===(s=this.state.settings)||void 0===s||null===(a=s.sort)||void 0===a?void 0:a.value)&&void 0!==J)switch(null===(M=this.state.settings)||void 0===M||null===(X=M.sort)||void 0===X?void 0:X.value){case"value":J.forEach((function(e,t){e.data.length>0&&(J[t].data=_.sortBy(e.data,["y"]))}));break;case"key":J.forEach((function(e,t){e.data.length>0&&(J[t].data=_.sortBy(e.data,["x"]))}))}return p.createElement(p.Fragment,null,p.createElement(O,null,p.createElement(oe.vZ,{data:J,margin:{top:(null===(r=this.state.settings)||void 0===r||null===(o=r.margin)||void 0===o?void 0:o.top)||40,right:(null===(l=this.state.settings)||void 0===l||null===(c=l.margin)||void 0===c?void 0:c.right)||180,bottom:(null===(d=this.state.settings)||void 0===d||null===(u=d.margin)||void 0===u?void 0:u.bottom)||80,left:(null===(h=this.state.settings)||void 0===h||null===(m=h.margin)||void 0===m?void 0:m.left)||100},xScale:null===(v=this.state.settings)||void 0===v?void 0:v.xScale,enableSliceLabels:!1,colors:"regagro"===(null===(f=this.state.settings)||void 0===f||null===(g=f.colors)||void 0===g?void 0:g.scheme)?ue:null===(b=this.state.settings)||void 0===b?void 0:b.colors,xFormat:"time"===(null===(y=this.state.settings)||void 0===y||null===(E=y.xScale)||void 0===E?void 0:E.type)&&"time:%d.%m.%Y",axisBottom:"time"===(null===(D=this.state.settings)||void 0===D||null===(w=D.xScale)||void 0===w?void 0:w.type)?de({format:this.state.settings.xScale.format},null===(k=this.state.settings)||void 0===k?void 0:k.axisBottom):de({},null===(S=this.state.settings)||void 0===S?void 0:S.axisBottom),enableGridY:null===(Z=this.state.settings)||void 0===Z?void 0:Z.enableGridY,enableGridX:null===(x=this.state.settings)||void 0===x?void 0:x.enableGridX,animate:Boolean(null===(N=this.state.settings)||void 0===N?void 0:N.enableAnimation)||!1,motionDamping:null===(R=this.state.settings)||void 0===R?void 0:R.animationMotionDamping,motionStiffness:null===(I=this.state.settings)||void 0===I?void 0:I.animationMotionStiffness,tooltip:function(e){var t;return p.createElement(le.Z,{enable:null===(t=H.state.settings)||void 0===t?void 0:t.enableCustomTooltip,datum:e,widgetID:H.props.widgetID})},legends:null!==(L=this.state.settings)&&void 0!==L&&L.enableLegend?[{anchor:(null===(j=this.state.settings)||void 0===j?void 0:j.legendAchor)||"bottom-right",direction:(null===(C=this.state.settings)||void 0===C?void 0:C.legendDirection)||"row",justify:(null===(A=this.state.settings)||void 0===A?void 0:A.legendJustify)||!1,translateX:(null===(z=this.state.settings)||void 0===z?void 0:z.legendTranslateX)||0,translateY:(null===(W=this.state.settings)||void 0===W?void 0:W.legendTranslateY)||0,itemsSpacing:(null===(q=this.state.settings)||void 0===q?void 0:q.legendItemsSpacing)||10,itemWidth:(null===(T=this.state.settings)||void 0===T?void 0:T.legendItemWidth)||10,itemHeight:(null===(B=this.state.settings)||void 0===B?void 0:B.legendItemHeight)||10,itemDirection:(null===(F=this.state.settings)||void 0===F?void 0:F.legendItemDirection)||"left-to-right",symbolSize:(null===(Y=this.state.settings)||void 0===Y?void 0:Y.legendSymbolSize)||25,symbolShape:"circle"}]:[]})))}}]),h}(p.Component);const he=(0,m.$j)((function(e){return{formsStore:_.cloneDeep(e.formsStore)}}))(pe);function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function ve(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const fe=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={sources:_.cloneDeep(e.sources),type:_.cloneDeep(e.type),editElement:_.cloneDeep(e.editElement),params:_.cloneDeep(e.params)},t}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){var n=this;if(!_.isEqual(e.editElement,this.props.editElement)){var i=_.cloneDeep(this.props.editElement,[]);this.setState((function(e){return ve(ve({},e),{},{editElement:i})}))}JSON.stringify(e.params)!==JSON.stringify(this.props.params)&&this.setState((function(e){return ve(ve({},e),{},{editElement:_.cloneDeep(n.props.editElement)})})),_.isEqual(e.type,this.props.type)||this.setState((function(e){return ve(ve({},e),{},{type:n.props.type})})),_.isEqual(e.sources,this.props.sources)||this.setState((function(e){return ve(ve({},e),{},{sources:n.props.sources})}))}},{key:"getWidget",value:function(){var e,t,n="Выберите тип диаграммы";switch(null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.type){case E.u3:n=this.renderBar();break;case E.en:n=this.renderPie();break;case E.fq:n=this.renderLine();break;case E.Fe:n=this.renderTable();break;case E.e_:n=this.renderScatter();break;default:n=p.createElement("div",null,"Выберите тип диаграммы")}return p.createElement("div",{className:"chart-container"},n)}},{key:"renderBar",value:function(){return p.createElement(B,{element:_.cloneDeep(this.props.editElement),sources:_.cloneDeep(this.state.sources),widgetID:this.props.widgetID})}},{key:"renderPie",value:function(){return p.createElement(J,{element:_.cloneDeep(this.props.editElement),sources:_.cloneDeep(this.state.sources),widgetID:this.props.widgetID})}},{key:"renderLine",value:function(){return p.createElement(re,{element:_.cloneDeep(this.props.editElement),sources:_.cloneDeep(this.state.sources),widgetID:this.props.widgetID})}},{key:"renderTable",value:function(){return p.createElement(K,{element:_.cloneDeep(this.props.editElement),sources:_.cloneDeep(this.state.sources)})}},{key:"renderScatter",value:function(){return p.createElement(he,{element:_.cloneDeep(this.props.editElement),sources:_.cloneDeep(this.state.sources),widgetID:this.props.widgetID})}},{key:"render",value:function(){return this.getWidget()}}]),s}(p.Component);var ge=n(80147),be=n(77579),ye=n(13981),Ee=n(62876),_e=n(91657),De=n(66616),we=n(14575),ke=n(16554);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}const Ze=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;(0,r.Z)(this,s),t=i.call(this,e);var n=_.cloneDeep(e.editElement);return t.state={el:n},t.ref=p.createRef(),t.downloadWidget=t.downloadWidget.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t,n){var i,s,a=this;_.isEqual(t.el,this.props.editElement)||this.setState((function(e){return Oe(Oe({},e),{},{el:_.cloneDeep(a.props.editElement)})})),JSON.stringify(null===(i=e.editElement.settings)||void 0===i?void 0:i.params)!==JSON.stringify(null===(s=this.props.editElement.settings)||void 0===s?void 0:s.params)&&this.setState((function(e){return Oe(Oe({},e),{},{el:_.cloneDeep(a.props.editElement)})}))}},{key:"downloadWidget",value:function(){(0,ge.exportComponentAsPNG)(this.ref,this.props.editElement.settings.name)}},{key:"render",value:function(){var e,t,n,i,s=this;return p.createElement("div",{className:"\r altrp-dashboard__card\r altrp-dashboard__card--border\r altrp-dashboard__card--border-radius\r altrp-dashboard__card--border-color\r altrp-dashboard__card--border-style\r altrp-dashboard__card--background\r altrp-dashboard__card--font"},p.createElement("div",{className:"title altrp-dashboards__cancle-drag"},p.createElement("div",{className:"\r altrp-dashboard__card--font\r altrp-dashboard__card--font-size\r altrp-dashboard__card--font-weight\r altrp-dashboard__card--font-color",style:{width:"100%"}},(null===(e=this.state.el.settings)||void 0===e?void 0:e.name)||""),p.createElement("div",{className:"dropdownTogglerContainer"},p.createElement(be.Z,{drop:"left"},p.createElement(be.Z.Toggle,{className:"altrp-dashboard__card--background",variant:"light"},p.createElement(ye.Z,{color:"#7a7a7b"})),p.createElement(be.Z.Menu,{className:"dropdownMenuToggle altrp-dashboard__card--settings-tooltip-background",style:{zIndex:999999,background:"rgba(255,255,255,1)"}},p.createElement(be.Z.Item,{className:"altrp-dashboard__card--settings-tooltip-background"},p.createElement("button",{type:"button",title:"Скачать файл",className:"altrp-dashboard__card--settings-tooltip-icon-background",onClick:this.downloadWidget},p.createElement(we.Z,null))),p.createElement(be.Z.Item,{className:"altrp-dashboard__card--settings-tooltip-background"},p.createElement("button",{type:"button",title:"Экспорт",className:"altrp-dashboard__card--settings-tooltip-icon-background",onClick:function(){return s.props.exportCard(s.state.el)}},p.createElement(De.Z,null))),p.createElement(be.Z.Item,{className:"altrp-dashboard__card--settings-tooltip-background"},p.createElement("button",{type:"button",title:"Дублировать",className:"altrp-dashboard__card--settings-tooltip-icon-background",onClick:function(){return s.props.copyWidget(s.state.el)}},p.createElement(ke.Z,null))),p.createElement(be.Z.Item,{className:"altrp-dashboard__card--settings-tooltip-background"},p.createElement("button",{type:"button",title:"Настроить",className:"altrp-dashboard__card--settings-tooltip-icon-background",onClick:function(){return s.props.openSettingsHandler(s.state.el)}},p.createElement(Ee.Z,null))),p.createElement(be.Z.Item,{className:"altrp-dashboard__card--settings-tooltip-background"},p.createElement("button",{type:"button",title:"Удалить",className:"altrp-dashboard__card--settings-tooltip-icon-background",onClick:function(){return s.props.onRemoveItem(s.state.el.i)}},p.createElement(_e.Z,null))))))),p.createElement(fe,{ref:this.ref,editElement:_.cloneDeep(this.state.el),params:_.cloneDeep(null===(t=this.state.el.settings)||void 0===t?void 0:t.params),type:_.cloneDeep(null===(n=this.state.el.settings)||void 0===n?void 0:n.type),sources:_.cloneDeep(null===(i=this.state.el.settings)||void 0===i?void 0:i.sources),widgetID:this.props.widgetID}))}}]),s}(p.Component);function xe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ne(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t,n,a;return(0,r.Z)(this,s),(a=i.call(this,e)).state={editElement:_.cloneDeep(e.editElement),cardName:null===(t=a.props.editElement)||void 0===t||null===(n=t.settings)||void 0===n?void 0:n.name,width:e.width},a.setCardName=a.setCardName.bind((0,l.Z)(a)),a}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t,n){var i,s,a,r,o,l,c,d,u=this;_.isEqual(e.editElement,this.props.editElement)||(this.props.addItemPreview,this.setState((function(e){return Ne(Ne({},e),{},{editElement:_.cloneDeep(u.props.editElement)})}))),JSON.stringify(null===(i=e.editElement)||void 0===i||null===(s=i.settings)||void 0===s?void 0:s.params)!==JSON.stringify(null===(a=this.props.editElement)||void 0===a||null===(r=a.settings)||void 0===r?void 0:r.params)&&this.setState((function(e){var t,n;return Ne(Ne({},e),{},{editElement:_.cloneDeep(u.props.editElement),cardName:null===(t=u.props.editElement)||void 0===t||null===(n=t.settings)||void 0===n?void 0:n.name})})),_.isEqual(null===(o=e.editElement)||void 0===o||null===(l=o.settings)||void 0===l?void 0:l.name,null===(c=this.props.editElement)||void 0===c||null===(d=c.settings)||void 0===d?void 0:d.name)||(this.props.addItemPreview?this.setState((function(e){var t;return Ne(Ne({},e),{},{editElement:_.cloneDeep(u.props.editElement),cardName:null===(t=u.props.editElement)||void 0===t?void 0:t.name})})):this.setState((function(e){var t,n;return Ne(Ne({},e),{},{editElement:_.cloneDeep(u.props.editElement),cardName:null===(t=u.props.editElement)||void 0===t||null===(n=t.settings)||void 0===n?void 0:n.name})})))}},{key:"setCardName",value:function(e){var t=e.target.value;this.setState((function(e){return Ne(Ne({},e),{},{cardName:t})})),this.props.setCardName(t,this.props.editElement)}},{key:"render",value:function(){var e,t,n,i,s,a,r,o;return _.isEmpty(this.state.editElement)?p.createElement("div",{className:"drawer-preview"},p.createElement("div",{className:"drawer-preview__container"},p.createElement("div",{className:"drawer-preview__container-content"},p.createElement("div",{className:"chart-container"},p.createElement("div",null,"Начните настраивать виджет"))))):p.createElement("div",{className:"drawer-preview",style:{width:"calc(100% - ".concat(this.state.width,")"),fallbacks:[{width:"-moz-calc(100% - ".concat(this.state.width,")")},{width:"-webkit-calc(100% - ".concat(this.state.width,")")},{width:"-o-calc(100% - ".concat(this.state.width,")")}]}},p.createElement("div",{className:"drawer-preview__container"},this.props.addItemPreview?p.createElement("div",{className:"title"},p.createElement("input",{type:"text",value:(null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.name)||this.state.cardName,placeholder:"Введите название диаграммы"})):p.createElement("div",{className:"title"},p.createElement("input",{type:"text",onChange:this.setCardName,value:this.state.cardName,placeholder:"Введите название диаграммы"})),p.createElement("div",{className:"drawer-preview__container-content"},p.createElement(fe,{sources:_.cloneDeep(null===(n=this.props.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.sources),params:_.cloneDeep(null===(s=this.props.editElement)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.params),type:_.cloneDeep(null===(r=this.props.editElement)||void 0===r||null===(o=r.settings)||void 0===o?void 0:o.type),editElement:_.cloneDeep(this.props.editElement)}))))}}]),s}(p.Component);const Re=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(Pe);var Ie=n(35005),Le=n(24278),je=n(37493),Ce=n(65398),Ae=n(548),ze=n(91902);function We(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?We(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Te=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={editElement:_.cloneDeep(e.editElement)},t.returnOptionsWithKeys=t.returnOptionsWithKeys.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){var n=this;_.isEqual(e.editElement,this.props.editElement)||this.setState((function(e){return qe(qe({},e),{},{editElement:_.cloneDeep(n.props.editElement)})}))}},{key:"componentWillMount",value:function(){if(1===this.props.datasources.length){var e=[this.returnOptionsWithKeys()[0]];this.props.setDatasource(e)}}},{key:"returnOptionsWithKeys",value:function(){return _.cloneDeep(this.props.datasources).map((function(e,t){return e.title=void 0!==e.title?e.title:e.path,e}))}},{key:"render",value:function(){var e,t,n=this;return null!==this.props.datasources?1===this.props.datasources.length?p.createElement(p.Fragment,null):p.createElement(p.Fragment,null,p.createElement("div",{className:"col-12"},p.createElement(Ae.Z.Group,{className:"mb-2"},p.createElement(Ae.Z.Label,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Источники данных"),p.createElement(ze.ZP,{isMulti:!0,placeholder:"Выберите источник данных",onChange:function(e){return n.props.setDatasource(e)},className:"select-type",defaultValue:null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.sources,name:"type",as:"select",styles:{menuList:function(e,t){return qe(qe({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menu:function(e,t){return qe(qe({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menuPortal:function(e,t){return qe(qe({},e),{},{zIndex:"999999999999999999999",position:"relative"})}},options:this.returnOptionsWithKeys(),getOptionValue:function(e){return e},getOptionLabel:function(e){return e.title}})))):p.createElement("div",{className:"col-12 text-center"},"Укажите источники данных в настройке виджета")}}]),s}(p.Component);const Be=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(Te);function Fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Fe(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He={menuList:function(e,t){return Ye(Ye({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menu:function(e,t){return Ye(Ye({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menuPortal:function(e,t){return Ye(Ye({},e),{},{zIndex:"999999999999999999999",position:"relative"})}},Ve=[{id:0,label:"Линейный",value:"linear"},{id:1,label:"Точечный",value:"point"},{id:2,label:"Временной",value:"time"}],Me=[{id:4,label:"День",value:"day"},{id:5,label:"Месяц",value:"month"},{id:6,label:"Год",value:"year"}],Xe=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;(0,r.Z)(this,s),t=i.call(this,e);var n=null!==e.editElement?_.cloneDeep(e.editElement):{};return t.state={editElement:n},t}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){var n,i,s=this;_.isEqual(null===(n=e.editElement)||void 0===n?void 0:n.settings,null===(i=this.props.editElement)||void 0===i?void 0:i.settings)||this.setState((function(e){return Ye(Ye({},e),{},{editElement:s.props.editElement})}))}},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b=this,y=null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t||null===(n=t.xScale)||void 0===n?void 0:n.type;return p.createElement("div",{className:"col mb-1"},p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Ось X"),p.createElement(ze.ZP,{placeholder:"Выберите отображение",options:Ve,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select select-type"),defaultValue:null===(i=this.state.editElement)||void 0===i||null===(s=i.settings)||void 0===s||null===(a=s.xScale)||void 0===a?void 0:a.type,defaultInputValue:(null===(r=_.find(Ve,{value:null===(o=this.state.editElement)||void 0===o||null===(l=o.settings)||void 0===l||null===(c=l.xScale)||void 0===c?void 0:c.type}))||void 0===r?void 0:r.label)||"",onChange:function(e){return b.props.setXAxisScale(e.value)},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:He})),void 0!==y&&"time"===y&&p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Масштаб времени"),p.createElement(ze.ZP,{placeholder:"Выберите масштаб времени",options:Me,className:"select-type",defaultValue:null===(d=this.state.editElement)||void 0===d||null===(u=d.settings)||void 0===u||null===(h=u.xScale)||void 0===h?void 0:h.precision,defaultInputValue:(null===(m=_.find(Me,{value:null===(v=this.state.editElement)||void 0===v||null===(f=v.settings)||void 0===f||null===(g=f.xScale)||void 0===g?void 0:g.precision}))||void 0===m?void 0:m.label)||"",onChange:function(e){return b.props.setXAxisTimeScale(e.value)},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:He})))}}]),s}(p.Component);const Je=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(Xe);function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Ue(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $e={left:80,right:80,bottom:80,top:40},Ke={left:120,right:180,bottom:80,top:80},Qe={left:100,right:120,bottom:80,top:40},et={top:40,right:180,bottom:80,left:100};const tt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t,n,a,o,c;(0,r.Z)(this,s),c=i.call(this,e);var d={left:30,right:30,bottom:30,top:30};switch(e.type){case E.fq:d=Qe;break;case E.u3:d=$e;break;case E.en:d=Ke;break;case E.e_:d=et}return c.state={margin:{left:(null===(t=e.margin)||void 0===t?void 0:t.left)||d.left,right:(null===(n=e.margin)||void 0===n?void 0:n.right)||d.right,bottom:(null===(a=e.margin)||void 0===a?void 0:a.bottom)||d.bottom,top:(null===(o=e.margin)||void 0===o?void 0:o.top)||d.top}},c.setProperty=c.setProperty.bind((0,l.Z)(c)),c}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){_.isEqual(e.margin,this.state.margin)||this.props.setProperty(this.state.margin,"margin")}},{key:"setProperty",value:function(e,t){this.setState((function(n){return Ue(Ue({},n),{},{margin:Ue(Ue({},n.margin),{},(0,a.Z)({},t,Number(e)))})}))}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"mt-2"},p.createElement("div",{className:"col"},p.createElement("div",{className:"row"},p.createElement("div",{className:"col px-0"},p.createElement("div",{htmlFor:"",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Слева:"),p.createElement("input",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--font-input"),style:{width:"100%"},type:"number",min:"0",defaultValue:this.state.margin.left,param:"left",onChange:function(t){return e.setProperty(t.target.value,"left")}})),p.createElement("div",{className:"col px-0"},p.createElement("div",{htmlFor:"",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Справа:"),p.createElement("input",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--font-input"),style:{width:"100%"},type:"number",min:"0",defaultValue:this.state.margin.right,param:"right",onChange:function(t){return e.setProperty(t.target.value,"right")}}))),p.createElement("div",{className:"row mt-1"},p.createElement("div",{className:"col px-0"},p.createElement("div",{htmlFor:"",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Сверху:"),p.createElement("input",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--font-input"),style:{width:"100%"},type:"number",min:"0",defaultValue:this.state.margin.top,param:"top",onChange:function(t){return e.setProperty(t.target.value,"top")}})),p.createElement("div",{className:"col px-0"},p.createElement("div",{htmlFor:"",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Снизу:"),p.createElement("input",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--font-input"),style:{width:"100%"},type:"number",min:"0",defaultValue:this.state.margin.bottom,param:"bottom",onChange:function(t){return e.setProperty(t.target.value,"bottom")}})))))}}]),s}(p.Component);var nt=n(63144),it=n(33012),st=n(50352);function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ot={menuList:function(e,t){return rt(rt({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menu:function(e,t){return rt(rt({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menuPortal:function(e,t){return rt(rt({},e),{},{zIndex:"999999999999999999999",position:"relative"})}},lt=_.find(A.Z,{value:"regagro"}).value,ct=[{id:0,value:"basis"},{id:1,value:"cardinal"},{id:2,value:"catmullRom"},{id:3,value:"linear"},{id:4,value:"monotoneX"},{id:5,value:"monotoneY"},{id:6,value:"natural"},{id:7,value:"step"},{id:8,value:"stepAfter"},{id:9,value:"stepBefore"}],dt=[{id:0,value:"horizontal",label:"Горизонтальный"},{id:1,value:"vertical",label:"Вертикальный"}],ut=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;(0,r.Z)(this,s),t=i.call(this,e);var n=null!==e.editElement?_.cloneDeep(e.editElement):{};return t.state={editElement:n,lineWidth:2,tickRotation:0,pointSize:6,innerRadius:0,padding:.1,innerPadding:0,sliceLabelsSkipAngle:0,sliceLabelsRadiusOffset:.5,radialLabelsSkipAngle:0,radialLabelsLinkOffset:0,radialLabelsLinkDiagonalLength:16,radialLabelsLinkHorizontalLength:24,radialLabelsTextXOffset:6,radialLabelsLinkStrokeWidth:1,labelSkipHeight:0,labelSkipWidth:0,currentColorScheme:"",cornerRadius:0,padAngle:0,borderWidth:0,borderColor:"",checked:!1},t.enableArea=t.enableArea.bind((0,l.Z)(t)),t.enableSliceLabels=t.enableSliceLabels.bind((0,l.Z)(t)),t.enableRadialLabels=t.enableRadialLabels.bind((0,l.Z)(t)),t.handleChange=t.handleChange.bind((0,l.Z)(t)),t.enablePoints=t.enablePoints.bind((0,l.Z)(t)),t.setReverse=t.setReverse.bind((0,l.Z)(t)),t.setColorScheme=t.setColorScheme.bind((0,l.Z)(t)),t.setSliceLabelsSkipAngle=t.setSliceLabelsSkipAngle.bind((0,l.Z)(t)),t.setRadialLabelsSkipAngle=t.setRadialLabelsSkipAngle.bind((0,l.Z)(t)),t.setSliceLabelsRadiusOffset=t.setSliceLabelsRadiusOffset.bind((0,l.Z)(t)),t.setRadialLabelsLinkOffset=t.setRadialLabelsLinkOffset.bind((0,l.Z)(t)),t.setRadialLabelsLinkDiagonalLength=t.setRadialLabelsLinkDiagonalLength.bind((0,l.Z)(t)),t.setRadialLabelsLinkHorizontalLength=t.setRadialLabelsLinkHorizontalLength.bind((0,l.Z)(t)),t.setRadialLabelsTextXOffset=t.setRadialLabelsTextXOffset.bind((0,l.Z)(t)),t.setRadialLabelsLinkStrokeWidth=t.setRadialLabelsLinkStrokeWidth.bind((0,l.Z)(t)),t.setLabelSkipHeight=t.setLabelSkipHeight.bind((0,l.Z)(t)),t.setLabelSkipWidth=t.setLabelSkipWidth.bind((0,l.Z)(t)),t.cornerRadius=t.cornerRadius.bind((0,l.Z)(t)),t.padAngle=t.padAngle.bind((0,l.Z)(t)),t.borderColor=t.borderColor.bind((0,l.Z)(t)),t.borderWidth=t.borderWidth.bind((0,l.Z)(t)),t.enableGridX=t.enableGridX.bind((0,l.Z)(t)),t.enableGridY=t.enableGridY.bind((0,l.Z)(t)),t.enableCrosshair=t.enableCrosshair.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"componentDidMount",value:function(){var e,t,n=this;void 0===(null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.color)&&setTimeout((function(){n.setColorScheme(lt)}),1e3)}},{key:"componentDidUpdate",value:function(e,t){var n,i,s=this;_.isEqual(null===(n=e.editElement)||void 0===n?void 0:n.settings,null===(i=this.props.editElement)||void 0===i?void 0:i.settings)||this.setState((function(e){return rt(rt({},e),{},{editElement:s.props.editElement})}))}},{key:"setColorScheme",value:function(e){this.props.setColorScheme(e),this.setState((function(t){return rt(rt({},t),{},{currentColorScheme:e})}))}},{key:"handleChange",value:function(e){console.log(e),e.persist(),this.setState((function(t){return rt(rt({},t),{},{checked:e.target.checked})}))}},{key:"changeWidth",value:function(e){this.props.setProperty(e,"lineWidth"),this.setState((function(t){return rt(rt({},t),{},{lineWidth:e})}))}},{key:"setTickRotation",value:function(e){this.props.setTickRotation(e),this.setState((function(t){return rt(rt({},t),{},{tickRotation:e})}))}},{key:"setPointSize",value:function(e){this.props.setProperty(e,"pointSize"),this.setState((function(t){return rt(rt({},t),{},{pointSize:e})}))}},{key:"setInnerRadius",value:function(e){this.props.setProperty(e,"innerRadius"),this.setState((function(t){return rt(rt({},t),{},{innerRadius:e})}))}},{key:"setPadding",value:function(e){this.props.setProperty(e,"padding"),this.setState((function(t){return rt(rt({},t),{},{padding:e})}))}},{key:"setInnerPadding",value:function(e){this.props.setProperty(e,"innerPadding"),this.setState((function(t){return rt(rt({},t),{},{innerPadding:e})}))}},{key:"enableArea",value:function(e){this.props.setProperty(e.target.checked,"enableArea")}},{key:"enableSliceLabels",value:function(e){this.props.setProperty(e.target.checked,"enableSliceLabels")}},{key:"enableRadialLabels",value:function(e){this.props.setProperty(e.target.checked,"enableRadialLabels")}},{key:"enablePoints",value:function(e){this.props.setProperty(e.target.checked,"enablePoints")}},{key:"enableGridX",value:function(e){this.props.setProperty(e.target.checked,"enableGridX")}},{key:"enableGridY",value:function(e){this.props.setProperty(e.target.checked,"enableGridY")}},{key:"enableCrosshair",value:function(e){this.props.setProperty(e.target.checked,"enableCrosshair")}},{key:"setReverse",value:function(e){this.props.setProperty(e.target.checked,"reverse")}},{key:"setSliceLabelsSkipAngle",value:function(e,t){this.props.setProperty(Number(t),"sliceLabelsSkipAngle")}},{key:"setRadialLabelsSkipAngle",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsSkipAngle")}},{key:"setSliceLabelsRadiusOffset",value:function(e,t){this.props.setProperty(Number(t),"sliceLabelsRadiusOffset")}},{key:"setRadialLabelsLinkOffset",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsLinkOffset")}},{key:"setRadialLabelsLinkDiagonalLength",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsLinkDiagonalLength")}},{key:"setRadialLabelsLinkHorizontalLength",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsLinkHorizontalLength")}},{key:"setRadialLabelsTextXOffset",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsTextXOffset")}},{key:"setRadialLabelsLinkStrokeWidth",value:function(e,t){this.props.setProperty(Number(t),"radialLabelsLinkStrokeWidth")}},{key:"setLabelSkipHeight",value:function(e,t){this.props.setProperty(Number(t),"labelSkipHeight")}},{key:"setLabelSkipWidth",value:function(e,t){this.props.setProperty(Number(t),"labelSkipWidth")}},{key:"cornerRadius",value:function(e,t){this.props.setProperty(Number(t),"cornerRadius")}},{key:"padAngle",value:function(e,t){this.props.setProperty(Number(t),"padAngle")}},{key:"borderWidth",value:function(e,t){this.props.setProperty(Number(t),"borderWidth")}},{key:"borderColor",value:function(e){this.props.setProperty(e.hex,"borderColor"),this.setState((function(t){return rt(rt({},t),{},{borderColor:e.hex})}))}},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,_,D,w,k,S,O,Z,x,N,P,R,I,L,j,C,z,W,q,T,B,F,Y,H,V,M,X,J,G,U,$,K,Q,ee,te,ne,ie,se,ae,re,oe,le,ce,de,ue,pe,he,me,ve,fe,ge,be,ye,Ee,_e,De,we,ke,Se,Oe,Ze,xe,Ne,Pe,Re,Ie,Le,je,Ce,Ae,We,qe,Te,Be,Fe,Ye,He,Ve,Me,Xe,Je,Ge,Ue,$e,Ke,Qe,et,at,rt,lt,ut,pt,ht,mt,vt,ft,gt,bt,yt,Et,_t,Dt,wt,kt,St,Ot,Zt,xt,Nt,Pt,Rt,It,Lt,jt,Ct,At,zt,Wt,qt,Tt,Bt,Ft,Yt,Ht,Vt,Mt,Xt,Jt,Gt=this;return p.createElement("div",{className:"col"},p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Укажите внутренние отступы"),p.createElement(tt,{widgetID:this.props.widgetID,setProperty:this.props.setProperty,type:null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.type,margin:null===(n=this.state.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.margin})),(null===(s=this.state.editElement)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.type)===E.fq&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Выберите тип кривой"),p.createElement(ze.ZP,{placeholder:"Выберите тип кривой",options:ct,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select"),defaultValue:null===(r=this.state.editElement)||void 0===r||null===(o=r.settings)||void 0===o?void 0:o.curve,defaultInputValue:null===(l=this.state.editElement)||void 0===l||null===(c=l.settings)||void 0===c?void 0:c.curve,onChange:function(e){return Gt.props.setProperty(e.value,"curve")},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.value},styles:ot}))),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Выберите цветовую схему"," "),p.createElement(ze.ZP,{options:A.Z,placeholder:"Выберите цветовую схему",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select"),defaultValue:(null===(d=this.props.editElement)||void 0===d||null===(u=d.settings)||void 0===u||null===(h=u.colors)||void 0===h?void 0:h.scheme)||this.state.currentColorScheme,defaultInputValue:(null===(m=this.props.editElement)||void 0===m||null===(v=m.settings)||void 0===v||null===(f=v.colors)||void 0===f?void 0:f.scheme)||this.state.currentColorScheme,onChange:function(e){return Gt.setColorScheme(e.value)},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.value},styles:ot})),(null===(g=this.state.editElement)||void 0===g||null===(b=g.settings)||void 0===b?void 0:b.type)===E.fq&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Укажите ширину линии"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(y=this.state.editElement)||void 0===y||null===(_=y.settings)||void 0===_?void 0:_.lineWidth)||this.state.lineWidth,onChange:function(e,t){return Gt.changeWidth(t)},min:0,max:20,step:1}),"(",(null===(D=this.state.editElement)||void 0===D||null===(w=D.settings)||void 0===w?void 0:w.lineWidth)||this.state.lineWidth,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить участки"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(k=this.state.editElement)||void 0===k||null===(S=k.settings)||void 0===S?void 0:S.enableArea)||!1,checked:null===(O=this.state.editElement)||void 0===O||null===(Z=O.settings)||void 0===Z?void 0:Z.enableArea,onChange:this.enableArea,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить точки"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(x=this.state.editElement)||void 0===x||null===(N=x.settings)||void 0===N?void 0:N.enablePoints)||!0,checked:null===(P=this.state.editElement)||void 0===P||null===(R=P.settings)||void 0===R?void 0:R.enablePoints,onChange:this.enablePoints,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить перекрестие"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(I=this.state.editElement)||void 0===I||null===(L=I.settings)||void 0===L?void 0:L.enableCrosshair)||!0,checked:null===(j=this.state.editElement)||void 0===j||null===(C=j.settings)||void 0===C?void 0:C.enableCrosshair,onChange:this.enableCrosshair,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Укажите размер точки"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(z=this.state.editElement)||void 0===z||null===(W=z.settings)||void 0===W?void 0:W.pointSize)||this.state.pointSize,onChange:function(e,t){return Gt.setPointSize(t)},min:2,max:20,step:1}),"(",(null===(q=this.state.editElement)||void 0===q||null===(T=q.settings)||void 0===T?void 0:T.pointSize)||this.state.pointSize,"px)")),((null===(B=this.state.editElement)||void 0===B||null===(F=B.settings)||void 0===F?void 0:F.type)!==E.en||(null===(Y=this.state.editElement)||void 0===Y||null===(H=Y.settings)||void 0===H?void 0:H.type)!==E.Fe)&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Укажите наклон нижней легенды"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(V=this.state.editElement)||void 0===V||null===(M=V.settings)||void 0===M||null===(X=M.axisBottom)||void 0===X?void 0:X.tickRotation)||this.state.tickRotation,onChange:function(e,t){return Gt.setTickRotation(t)},min:-90,max:90,step:1}),"(",(null===(J=this.state.editElement)||void 0===J||null===(G=J.settings)||void 0===G||null===(U=G.axisBottom)||void 0===U?void 0:U.tickRotation)||this.state.tickRotation,"°)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить сетку по X"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===($=this.state.editElement)||void 0===$||null===(K=$.settings)||void 0===K?void 0:K.enableGridX)||!0,checked:null===(Q=this.state.editElement)||void 0===Q||null===(ee=Q.settings)||void 0===ee?void 0:ee.enableGridX,onChange:this.enableGridX,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить сетку по Y"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(te=this.state.editElement)||void 0===te||null===(ne=te.settings)||void 0===ne?void 0:ne.enableGridY)||!0,checked:null===(ie=this.state.editElement)||void 0===ie||null===(se=ie.settings)||void 0===se?void 0:se.enableGridY,onChange:this.enableGridY,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")}))),(null===(ae=this.state.editElement)||void 0===ae||null===(re=ae.settings)||void 0===re?void 0:re.type)===E.en&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Укажите внутренний радиус"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(oe=this.state.editElement)||void 0===oe||null===(le=oe.settings)||void 0===le?void 0:le.innerRadius)||this.state.innerRadius,onChange:function(e,t){return Gt.setInnerRadius(t)},min:0,max:.95,step:.05}),"(",(null===(ce=this.state.editElement)||void 0===ce||null===(de=ce.settings)||void 0===de?void 0:de.innerRadius)||this.state.innerRadius,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Надписи на сегментах"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(ue=this.state.editElement)||void 0===ue||null===(pe=ue.settings)||void 0===pe?void 0:pe.enableSliceLabels)||!0,checked:null===(he=this.state.editElement)||void 0===he||null===(me=he.settings)||void 0===me?void 0:me.enableSliceLabels,onChange:this.enableSliceLabels,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Пропускать внутренние подписи при угле сектора"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(ve=this.state.editElement)||void 0===ve||null===(fe=ve.settings)||void 0===fe?void 0:fe.sliceLabelsSkipAngle)||this.state.sliceLabelsSkipAngle,onChange:this.setSliceLabelsSkipAngle,min:0,max:45,step:1}),"(",(null===(ge=this.state.editElement)||void 0===ge||null===(be=ge.settings)||void 0===be?void 0:be.sliceLabelsSkipAngle)||this.state.sliceLabelsSkipAngle,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отступ внутренних подписей"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(ye=this.state.editElement)||void 0===ye||null===(Ee=ye.settings)||void 0===Ee?void 0:Ee.sliceLabelsRadiusOffset)||this.state.sliceLabelsRadiusOffset,onChange:this.setSliceLabelsRadiusOffset,min:0,max:2,step:.05}),"(",(null===(_e=this.state.editElement)||void 0===_e||null===(De=_e.settings)||void 0===De?void 0:De.sliceLabelsRadiusOffset)||this.state.sliceLabelsRadiusOffset,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Внешние надписи"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(we=this.state.editElement)||void 0===we||null===(ke=we.settings)||void 0===ke?void 0:ke.enableRadialLabels)||!0,checked:null===(Se=this.state.editElement)||void 0===Se||null===(Oe=Se.settings)||void 0===Oe?void 0:Oe.enableRadialLabels,onChange:this.enableRadialLabels,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Пропускать внешние подписи при угле сектора"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Ze=this.state.editElement)||void 0===Ze||null===(xe=Ze.settings)||void 0===xe?void 0:xe.radialLabelsSkipAngle)||this.state.radialLabelsSkipAngle,onChange:this.setRadialLabelsSkipAngle,min:0,max:45,step:1}),"(",(null===(Ne=this.state.editElement)||void 0===Ne||null===(Pe=Ne.settings)||void 0===Pe?void 0:Pe.radialLabelsSkipAngle)||this.state.radialLabelsSkipAngle,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отступы внешней подписи"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Re=this.state.editElement)||void 0===Re||null===(Ie=Re.settings)||void 0===Ie?void 0:Ie.radialLabelsLinkOffset)||this.state.radialLabelsLinkOffset,onChange:this.setRadialLabelsLinkOffset,min:-48,max:60,step:1}),"(",(null===(Le=this.state.editElement)||void 0===Le||null===(je=Le.settings)||void 0===je?void 0:je.radialLabelsLinkOffset)||this.state.radialLabelsLinkOffset,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Длина линии подписи по диагонали"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Ce=this.state.editElement)||void 0===Ce||null===(Ae=Ce.settings)||void 0===Ae?void 0:Ae.radialLabelsLinkDiagonalLength)||this.state.radialLabelsLinkDiagonalLength,onChange:this.setRadialLabelsLinkDiagonalLength,min:0,max:60,step:1})," ","(",(null===(We=this.state.editElement)||void 0===We||null===(qe=We.settings)||void 0===qe?void 0:qe.radialLabelsLinkDiagonalLength)||this.state.radialLabelsLinkDiagonalLength,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Длина линии подписи по горизонтали"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Te=this.state.editElement)||void 0===Te||null===(Be=Te.settings)||void 0===Be?void 0:Be.radialLabelsLinkHorizontalLength)||this.state.radialLabelsLinkHorizontalLength,onChange:this.setRadialLabelsLinkHorizontalLength,min:0,max:60,step:1}),"(",(null===(Fe=this.state.editElement)||void 0===Fe||null===(Ye=Fe.settings)||void 0===Ye?void 0:Ye.radialLabelsLinkHorizontalLength)||this.state.radialLabelsLinkHorizontalLength,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отступ внешней подписи по горизонтали"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(He=this.state.editElement)||void 0===He||null===(Ve=He.settings)||void 0===Ve?void 0:Ve.radialLabelsTextXOffset)||this.state.radialLabelsTextXOffset,onChange:this.setRadialLabelsTextXOffset,min:0,max:60,step:1}),"(",(null===(Me=this.state.editElement)||void 0===Me||null===(Xe=Me.settings)||void 0===Xe?void 0:Xe.radialLabelsTextXOffset)||this.state.radialLabelsTextXOffset,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Толщина линии внешней подписи"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Je=this.state.editElement)||void 0===Je||null===(Ge=Je.settings)||void 0===Ge?void 0:Ge.radialLabelsLinkStrokeWidth)||this.state.radialLabelsLinkStrokeWidth,onChange:this.setRadialLabelsLinkStrokeWidth,min:0,max:20,step:1}),"(",(null===(Ue=this.state.editElement)||void 0===Ue||null===($e=Ue.settings)||void 0===$e?void 0:$e.radialLabelsLinkStrokeWidth)||this.state.radialLabelsLinkStrokeWidth,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Скругление углов сегмента"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Ke=this.state.editElement)||void 0===Ke||null===(Qe=Ke.settings)||void 0===Qe?void 0:Qe.cornerRadius)||this.state.cornerRadius,onChange:this.cornerRadius,min:0,max:45,step:1}),"(",(null===(et=this.state.editElement)||void 0===et||null===(at=et.settings)||void 0===at?void 0:at.cornerRadius)||this.state.cornerRadius,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Угол между сегментами"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(rt=this.state.editElement)||void 0===rt||null===(lt=rt.settings)||void 0===lt?void 0:lt.padAngle)||this.state.padAngle,onChange:this.padAngle,min:0,max:45,step:1}),"(",(null===(ut=this.state.editElement)||void 0===ut||null===(pt=ut.settings)||void 0===pt?void 0:pt.padAngle)||this.state.padAngle,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Толщина рамки сегментов"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(ht=this.state.editElement)||void 0===ht||null===(mt=ht.settings)||void 0===mt?void 0:mt.borderWidth)||this.state.borderWidth,onChange:this.borderWidth,min:0,max:20,step:1}),"(",(null===(vt=this.state.editElement)||void 0===vt||null===(ft=vt.settings)||void 0===ft?void 0:ft.borderWidth)||this.state.borderWidth,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Цвет рамки сегментов"),p.createElement(nt.xS,{color:(null===(gt=this.state.editElement)||void 0===gt||null===(bt=gt.settings)||void 0===bt?void 0:bt.borderColor)||this.state.borderColor,onChange:this.borderColor}))),(null===(yt=this.state.editElement)||void 0===yt||null===(Et=yt.settings)||void 0===Et?void 0:Et.type)===E.u3&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Надписи на сегментах"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(_t=this.state.editElement)||void 0===_t||null===(Dt=_t.settings)||void 0===Dt?void 0:Dt.enableSliceLabels)||!0,checked:null===(wt=this.state.editElement)||void 0===wt||null===(kt=wt.settings)||void 0===kt?void 0:kt.enableSliceLabels,onChange:this.enableSliceLabels,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Внешние отступы"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(St=this.state.editElement)||void 0===St||null===(Ot=St.settings)||void 0===Ot?void 0:Ot.padding)||this.state.padding,onChange:function(e,t){return Gt.setPadding(t)},min:0,max:.9,step:.05}),"(",(null===(Zt=this.state.editElement)||void 0===Zt||null===(xt=Zt.settings)||void 0===xt?void 0:xt.padding)||this.state.padding,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Внутренние отступы"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Nt=this.state.editElement)||void 0===Nt||null===(Pt=Nt.settings)||void 0===Pt?void 0:Pt.innerPadding)||this.state.innerPadding,onChange:function(e,t){return Gt.setInnerPadding(t)},min:0,max:10,step:1}),"(",(null===(Rt=this.state.editElement)||void 0===Rt||null===(It=Rt.settings)||void 0===It?void 0:It.innerPadding)||this.state.innerPadding,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Пропускать подписи при высоте столбца"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(Lt=this.state.editElement)||void 0===Lt||null===(jt=Lt.settings)||void 0===jt?void 0:jt.labelSkipHeight)||this.state.labelSkipHeight,onChange:this.setLabelSkipHeight,min:0,max:36,step:1}),"(",(null===(Ct=this.state.editElement)||void 0===Ct||null===(At=Ct.settings)||void 0===At?void 0:At.labelSkipHeight)||this.state.labelSkipHeight,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Пропускать подписи при ширине столбца"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(zt=this.state.editElement)||void 0===zt||null===(Wt=zt.settings)||void 0===Wt?void 0:Wt.labelSkipWidth)||this.state.labelSkipWidth,onChange:this.setLabelSkipWidth,min:0,max:36,step:1}),"(",(null===(qt=this.state.editElement)||void 0===qt||null===(Tt=qt.settings)||void 0===Tt?void 0:Tt.labelSkipWidth)||this.state.labelSkipWidth,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отразить"),p.createElement(it.Z,{disableRipple:!0,defaultChecked:(null===(Bt=this.state.editElement)||void 0===Bt||null===(Ft=Bt.settings)||void 0===Ft?void 0:Ft.reverse)||!1,checked:null===(Yt=this.state.editElement)||void 0===Yt||null===(Ht=Yt.settings)||void 0===Ht?void 0:Ht.reverse,onChange:this.setReverse,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Тип макета"),p.createElement(ze.ZP,{options:dt,placeholder:"Выберите тип макета",className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select select-type"),defaultValue:null===(Vt=this.state.editElement)||void 0===Vt||null===(Mt=Vt.settings)||void 0===Mt?void 0:Mt.layout,defaultInputValue:null===(Xt=this.state.editElement)||void 0===Xt||null===(Jt=Xt.settings)||void 0===Jt?void 0:Jt.layout,onChange:function(e){return Gt.props.setProperty(e.value,"layout")},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:ot}))))}}]),s}(p.Component);const pt=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e(editElement(t))}}}))(ut);function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function mt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var vt=function(e){(0,c.Z)(h,e);var t,n,i,s,a=(i=h,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=(0,u.Z)(i);if(s){var n=(0,u.Z)(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return(0,d.Z)(this,e)});function h(e){var t;return(0,r.Z)(this,h),(t=a.call(this,e)).state={param:_.cloneDeep(e.param),options:[],editElement:_.cloneDeep(e.editElement),currentSelected:""},t.setOption=t.setOption.bind((0,l.Z)(t)),t}return(0,o.Z)(h,[{key:"componentDidUpdate",value:function(e,t){var n=this;_.isEqual(e.param,this.props.param)||this.setState((function(e){return mt(mt({},e),{},{param:_.cloneDeep(n.props.param)})})),_.isEqual(t.editElement,this.props.editElement)||this.setState((function(e){return mt(mt({},e),{},{editElement:_.cloneDeep(n.props.editElement)})}))}},{key:"componentDidMount",value:function(){var e,t,n=this,i=_.find(null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.params,(function(e){return void 0!==e[n.state.param.value]&&null!=e[n.state.param.value]?(console.log(e[n.state.param.value]),e[n.state.param.value]):""}));if(void 0!==i){var s=_.keys(i)[0];this.setState((function(e){return mt(mt({},e),{},{currentSelected:i[s]||""})}))}}},{key:"componentWillMount",value:(n=(0,D.Z)(k().mark((function e(){return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOptions();case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"getOptions",value:(t=(0,D.Z)(k().mark((function e(){var t;return k().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,b()("/ajax/models/queries/".concat(this.state.param.model,"/").concat(this.state.param.value));case 3:200===(t=e.sent).status&&this.setState((function(e){return mt(mt({},e),{},{options:t.data.data})})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log("NETWORK ERROR =>",e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])}))),function(){return t.apply(this,arguments)})},{key:"setOption",value:function(e){var t,n=this;this.props.setParam(this.state.param.value,e,this.state.options,(null===(t=_.find(this.state.options,(function(e){return e.value==n.state.currentSelected})))||void 0===t?void 0:t.label)||""),this.setState((function(t){return mt(mt({},t),{},{currentSelected:e})}))}},{key:"render",value:function(){var e=this;return p.createElement("div",{className:"col-12"},p.createElement(Ae.Z.Group,{className:"mb-2"},p.createElement(Ae.Z.Label,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},this.state.param.label),p.createElement(Ae.Z.Control,{className:"select-type",name:"type",defaultValue:this.state.currentSelected,value:this.state.currentSelected,onChange:function(t){return e.setOption(t.target.value)},as:"select"},p.createElement("option",{value:""},"Выберите параметры для фильтрации"),this.state.options.length>0&&this.state.options.map((function(e,t){return p.createElement("option",{key:t,value:e.value},e.label)})))))}}]),h}(p.Component);const ft=(0,m.$j)((function(e){return{editElement:e.editElement}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(vt);var gt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;(0,r.Z)(this,s),t=i.call(this,e);var n=null!==e.editElement?_.cloneDeep(e.editElement):{};return t.state={types:E.eq,editElement:n},t}return(0,o.Z)(s,[{key:"render",value:function(){var e,t,n=this;return p.createElement("div",{className:"col-12"},p.createElement(Ae.Z.Group,null,p.createElement(Ae.Z.Label,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Тип диаграммы"),p.createElement(Ae.Z.Control,{onChange:function(e){return n.props.setType(e.target.value)},value:null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.type,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select select-type"),name:"type",as:"select"},p.createElement("option",{value:""},"Выберите тип диаграммы"),this.state.types&&this.state.types.map((function(e,t){return p.createElement("option",{key:t,value:e.value},e.name)})))))}}]),s}(p.Component);const bt=(0,m.$j)((function(e){return{editElement:e.editElement}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(gt);function yt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _t={menuList:function(e,t){return Et(Et({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menu:function(e,t){return Et(Et({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menuPortal:function(e,t){return Et(Et({},e),{},{zIndex:"999999999999999999999",position:"relative"})}},Dt=[{value:"top-left",label:"Сверху слева"},{value:"top",label:"Сверху"},{value:"top-right",label:"Сверху справа"},{value:"left",label:"Слева"},{value:"center",label:"По центру"},{value:"right",label:"Справа"},{value:"bottom-left",label:"Снизу слева"},{value:"bottom",label:"Снизу"},{value:"bottom-right",label:"Снизу справа"}],wt=[{value:"column",label:"Колонка"},{value:"row",label:"Строчка"}],kt=[{value:"left-to-right",label:"Слева направо"},{value:"right-to-left",label:"Справа налево"},{value:"top-to-bottom",label:"Сверху вниз"},{value:"bottom-to-top",label:"Снизу вверх"}],St=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={editElement:e.editElement,enableLegend:!0,legendTranslateX:0,legendTranslateY:0,itemWidth:10,itemHeight:10,itemsSpacing:10,symbolSize:10},t.setLedengEnable=t.setLedengEnable.bind((0,l.Z)(t)),t.setLegendJustify=t.setLegendJustify.bind((0,l.Z)(t)),t.setProperty=t.setProperty.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){var n=this;_.isEqual(e.editElement,this.props.editElement)||this.setState((function(e){return Et(Et({},e),{},{editElement:n.props.editElement})}))}},{key:"setLedengEnable",value:function(e){this.props.setProperty(e.target.checked,"enableLegend")}},{key:"setLegendJustify",value:function(e){this.props.setProperty(e.target.checked,"legendJustify")}},{key:"setProperty",value:function(e,t){this.props.setProperty(e,t),this.setState((function(n){return Et(Et({},n),{},(0,a.Z)({},t,e))}))}},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,E,_,D,w,k,S,O,Z,x,N,P,R,I,L,j,C,A,z,W,q,T,B,F,Y,H,V=this;return p.createElement(p.Fragment,null,p.createElement("div",{className:"col"},p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить легенду"),p.createElement(it.Z,{disableRipple:!0,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor"),defaultChecked:null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.enableLegend,checked:null===(n=this.state.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.enableLegend,onChange:this.setLedengEnable})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Расположение легенды"),p.createElement(ze.ZP,{placeholder:"Выберите расположение легенды",options:Dt,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select"),defaultValue:null===(s=this.state.editElement)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.legendAchor,defaultInputValue:null===(r=this.state.editElement)||void 0===r||null===(o=r.settings)||void 0===o?void 0:o.legendAchor,onChange:function(e){return V.props.setProperty(e.value,"legendAchor")},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:_t})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Направление легенды"),p.createElement(ze.ZP,{placeholder:"Выберите расположение легенды",options:wt,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select"),defaultValue:null===(l=this.state.editElement)||void 0===l||null===(c=l.settings)||void 0===c?void 0:c.legendDirection,defaultInputValue:null===(d=this.state.editElement)||void 0===d||null===(u=d.settings)||void 0===u?void 0:u.legendDirection,onChange:function(e){return V.props.setProperty(e.value,"legendDirection")},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:_t})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Выровнять легенды"),p.createElement(it.Z,{disableRipple:!0,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor"),defaultChecked:null===(h=this.state.editElement)||void 0===h||null===(m=h.settings)||void 0===m?void 0:m.legendJustify,checked:null===(v=this.state.editElement)||void 0===v||null===(f=v.settings)||void 0===f?void 0:f.legendJustify,onChange:this.setLegendJustify})),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Расположение легенды по X"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(g=this.state.editElement)||void 0===g||null===(b=g.settings)||void 0===b?void 0:b.legendTranslateX)||this.state.legendTranslateX,onChange:function(e,t){return V.setProperty(Number(t),"legendTranslateX")},min:-200,max:200,step:1}),"(",(null===(y=this.state.editElement)||void 0===y||null===(E=y.settings)||void 0===E?void 0:E.legendTranslateX)||this.state.legendTranslateX,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Расположение легенды по Y"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(_=this.state.editElement)||void 0===_||null===(D=_.settings)||void 0===D?void 0:D.legendTranslateY)||this.state.legendTranslateY,onChange:function(e,t){return V.setProperty(Number(t),"legendTranslateY")},min:-200,max:200,step:1}),"(",(null===(w=this.state.editElement)||void 0===w||null===(k=w.settings)||void 0===k?void 0:k.legendTranslateY)||this.state.legendTranslateY,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Ширина элемента легенды"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(S=this.state.editElement)||void 0===S||null===(O=S.settings)||void 0===O?void 0:O.legendItemWidth)||this.state.itemWidth,onChange:function(e,t){return V.setProperty(Number(t),"itemWlegendItemWidthidth")},min:10,max:200,step:1}),"(",(null===(Z=this.state.editElement)||void 0===Z||null===(x=Z.settings)||void 0===x?void 0:x.legendItemWidth)||this.state.itemWidth,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Высота элемента легенды"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(N=this.state.editElement)||void 0===N||null===(P=N.settings)||void 0===P?void 0:P.legendItemHeight)||this.state.itemHeight,onChange:function(e,t){return V.setProperty(Number(t),"legendItemHeight")},min:10,max:200,step:1}),"(",(null===(R=this.state.editElement)||void 0===R||null===(I=R.settings)||void 0===I?void 0:I.legendItemHeight)||this.state.itemHeight,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Расстояние между элементами"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(L=this.state.editElement)||void 0===L||null===(j=L.settings)||void 0===j?void 0:j.legendItemsSpacing)||this.state.itemsSpacing,onChange:function(e,t){return V.setProperty(Number(t),"legendItemsSpacing")},min:0,max:60,step:1}),"(",(null===(C=this.state.editElement)||void 0===C||null===(A=C.settings)||void 0===A?void 0:A.legendItemsSpacing)||this.state.itemsSpacing,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Размер символа"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(z=this.state.editElement)||void 0===z||null===(W=z.settings)||void 0===W?void 0:W.legendSymbolSize)||this.state.symbolSize,onChange:function(e,t){return V.setProperty(Number(t),"legendSymbolSize")},min:2,max:60,step:1}),"(",(null===(q=this.state.editElement)||void 0===q||null===(T=q.settings)||void 0===T?void 0:T.legendSymbolSize)||this.state.symbolSize,"px)"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Направление элементов"),p.createElement(ze.ZP,{placeholder:"Выберите направление элементов",options:kt,className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select"),defaultValue:null===(B=this.state.editElement)||void 0===B||null===(F=B.settings)||void 0===F?void 0:F.legendItemDirection,defaultInputValue:null===(Y=this.state.editElement)||void 0===Y||null===(H=Y.settings)||void 0===H?void 0:H.legendItemDirection,onChange:function(e){return V.props.setProperty(e.value,"legendItemDirection")},getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label},styles:_t}))))}}]),s}(p.Component);const Ot=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e(editElement(t))}}}))(St);function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}p.Component;var Nt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={editElement:e.editElement,padding:{left:5,right:5,top:5,bottom:5},currentColorScheme:"",lineWidth:2},t.setTooltipEnable=t.setTooltipEnable.bind((0,l.Z)(t)),t.setColorScheme=t.setColorScheme.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"componentDidMount",value:function(){var e,t,n=this;void 0===(null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.color)&&setTimeout((function(){n.setColorScheme(regagroScheme)}),1e3)}},{key:"setColorScheme",value:function(e){this.props.setColorScheme(e),this.setState((function(t){return xt(xt({},t),{},{currentColorScheme:e})}))}},{key:"componentDidUpdate",value:function(e,t){var n=this;_.isEqual(e.editElement,this.props.editElement)||this.setState((function(e){return xt(xt({},e),{},{editElement:n.props.editElement})}))}},{key:"setTooltipEnable",value:function(e){this.props.setProperty(e.target.checked,"enableCustomTooltip")}},{key:"changeWidth",value:function(e){this.props.setProperty(e,"lineWidth"),this.setState((function(t){return xt(xt({},t),{},{lineWidth:e})}))}},{key:"render",value:function(){var e,t,n,i;return React.createElement(React.Fragment,null,React.createElement("div",{className:"col"},React.createElement("div",{className:"mb-3"},React.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Отобразить собственные подсказки"),React.createElement(it.Z,{disableRipple:!0,defaultChecked:null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.enableCustomTooltip,checked:null===(n=this.state.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.enableCustomTooltip,onChange:this.setTooltipEnable,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor")}))))}}]),s}(p.Component);const Pt=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e(editElement(t))}}}))(Nt);function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function It(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Lt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={editElement:e.editElement,animationMotionStiffness:90,animationMotionDamping:15,animationEnabled:!0},t.setAnimationEnable=t.setAnimationEnable.bind((0,l.Z)(t)),t}return(0,o.Z)(s,[{key:"setAnimationEnable",value:function(e){this.props.setProperty(e.target.checked,"enableAnimation")}},{key:"setProperty",value:function(e,t){this.props.setProperty(e,t),this.setState((function(n){return It(It({},n),{},(0,a.Z)({},t,e))}))}},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u,h,m,v,f,g,b,y,_,D,w,k=this;return p.createElement(p.Fragment,null,p.createElement("div",{className:"col"},((null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.type)===E.fq||(null===(n=this.state.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.type)===E.e_||(null===(s=this.state.editElement)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.type)===E.u3)&&p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Включить анимацию"),p.createElement(it.Z,{disableRipple:!0,className:"".concat(this.props.widgetID," altrp-dashboard__checkboxcolor"),defaultChecked:null===(r=this.props.editElement)||void 0===r||null===(o=r.settings)||void 0===o?void 0:o.enableAnimation,checked:null===(l=this.props.editElement)||void 0===l||null===(c=l.settings)||void 0===c?void 0:c.enableAnimation,onChange:this.setAnimationEnable})),((null===(d=this.state.editElement)||void 0===d||null===(u=d.settings)||void 0===u?void 0:u.type)===E.e_||(null===(h=this.state.editElement)||void 0===h||null===(m=h.settings)||void 0===m?void 0:m.type)===E.u3)&&p.createElement(p.Fragment,null,p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Жесткость движения"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(v=this.state.editElement)||void 0===v||null===(f=v.settings)||void 0===f?void 0:f.animationMotionStiffness)||this.state.animationMotionStiffness,onChange:function(e,t){return k.setProperty(Number(t),"animationMotionStiffness")},min:0,max:90,step:1}),"(",(null===(g=this.state.editElement)||void 0===g||null===(b=g.settings)||void 0===b?void 0:b.animationMotionStiffness)||this.state.animationMotionStiffness,")"),p.createElement("div",{className:"mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Затухаение движения"),p.createElement(st.Z,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--range-drawer-color"),defaultValue:(null===(y=this.state.editElement)||void 0===y||null===(_=y.settings)||void 0===_?void 0:_.animationMotionDamping)||this.state.animationMotionDamping,onChange:function(e,t){return k.setProperty(Number(t),"animationMotionDamping")},min:0,max:40,step:1}),"(",(null===(D=this.state.editElement)||void 0===D||null===(w=D.settings)||void 0===w?void 0:w.animationMotionDamping)||this.state.animationMotionDamping,")"))))}}]),s}(p.Component);const jt=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e(editElement(t))}}}))(Lt);function Ct(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function At(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ct(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ct(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var zt=[{id:0,label:"По умолчанию",value:""},{id:1,label:"По значению",value:"value"},{id:2,label:"По названию",value:"key"}],Wt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t;return(0,r.Z)(this,s),(t=i.call(this,e)).state={editElement:e.editElement},t}return(0,o.Z)(s,[{key:"render",value:function(){var e,t,n=this;return p.createElement(p.Fragment,null,p.createElement("div",{className:"col-12"},p.createElement(Ae.Z.Group,{className:"mb-2"},p.createElement(Ae.Z.Label,{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Сортировать"),p.createElement(ze.ZP,{placeholder:"Выберите фильтр",onChange:function(e){return n.props.setProperty(e,"sort")},className:"".concat(this.props.widgetID," altrp-dashboard__drawer--select select-type"),defaultValue:(null===(e=this.state.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.sort)||zt[0].value,name:"type",as:"select",styles:{menuList:function(e,t){return At(At({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menu:function(e,t){return At(At({},e),{},{zIndex:"999999999999999999999",position:"relative"})},menuPortal:function(e,t){return At(At({},e),{},{zIndex:"999999999999999999999",position:"relative"})}},options:zt,getOptionValue:function(e){return e.value},getOptionLabel:function(e){return e.label}}))))}}]),s}(p.Component);const qt=(0,m.$j)((function(e){return{editElement:e.editElement}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(Wt);function Tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ft=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){var t,n;return(0,r.Z)(this,s),(n=i.call(this,e)).state={settings:_.cloneDeep(null===(t=e.editElement)||void 0===t?void 0:t.settings,{})||{},datasources:e.datasources,openDataSettings:!1,openDiagramSettings:!1,openTooltipSettings:!1,openLegendSettings:!1,openAnimationSettings:!1,filter_datasource:e.filter_datasource,editElement:_.cloneDeep(e.editElement,{})||{},delimer:e.delimer},n.setDatasource=n.setDatasource.bind((0,l.Z)(n)),n.setType=n.setType.bind((0,l.Z)(n)),n.setParam=n.setParam.bind((0,l.Z)(n)),n.setXAxisScale=n.setXAxisScale.bind((0,l.Z)(n)),n.setXAxisTimeScale=n.setXAxisTimeScale.bind((0,l.Z)(n)),n.setYAxisScale=n.setYAxisScale.bind((0,l.Z)(n)),n.setColorScheme=n.setColorScheme.bind((0,l.Z)(n)),n.setTickRotation=n.setTickRotation.bind((0,l.Z)(n)),n.generateName=n.generateName.bind((0,l.Z)(n)),n.setName=n.setName.bind((0,l.Z)(n)),n.setProperty=n.setProperty.bind((0,l.Z)(n)),n}return(0,o.Z)(s,[{key:"componentDidUpdate",value:function(e,t){var n,i,s,a,r,o,l,c,d=this;_.isEqual(e.datasources,this.props.datasources)||this.setState((function(e){return Bt(Bt({},e),{},{datasources:d.props.datasources})})),_.isEqual(e.filter_datasource,this.props.filter_datasource)||this.setState((function(e){return Bt(Bt({},e),{},{filter_datasource:d.props.filter_datasource})})),_.isEqual(e.editElement,this.props.editElement)||this.setState((function(e){var t;return Bt(Bt({},e),{},{editElement:_.cloneDeep(d.props.editElement),settings:_.cloneDeep(null===(t=d.props.editElement)||void 0===t?void 0:t.settings,{})})})),this.props.addItemPreview||_.isEqual(null===(r=e.editElement)||void 0===r||null===(o=r.settings)||void 0===o?void 0:o.name,null===(l=this.props.editElement)||void 0===l||null===(c=l.settings)||void 0===c?void 0:c.name)||this.setState((function(e){var t;return Bt(Bt({},e),{},{editElement:_.cloneDeep(d.props.editElement),settings:_.cloneDeep(null===(t=d.props.editElement)||void 0===t?void 0:t.settings,{})})})),JSON.stringify(null===(n=e.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.params)!==JSON.stringify(null===(s=this.props.editElement)||void 0===s||null===(a=s.settings)||void 0===a?void 0:a.params)&&this.setState((function(e){var t;return Bt(Bt({},e),{},{editElement:_.cloneDeep(d.props.editElement),settings:_.cloneDeep(null===(t=d.props.editElement)||void 0===t?void 0:t.settings,{})})}))}},{key:"setOpenDataSettings",value:function(e){this.setState((function(t){return Bt(Bt({},t),{},{openDataSettings:e})}))}},{key:"setOpenDiagramSettings",value:function(e){this.setState((function(t){return Bt(Bt({},t),{},{openDiagramSettings:e})}))}},{key:"setOpenTooltipSettings",value:function(e){this.setState((function(t){return Bt(Bt({},t),{},{openTooltipSettings:e})}))}},{key:"setOpenLegendSettings",value:function(e){this.setState((function(t){return Bt(Bt({},t),{},{openLegendSettings:e})}))}},{key:"setOpenAnimationSettings",value:function(e){this.setState((function(t){return Bt(Bt({},t),{},{openAnimationSettings:e})}))}},{key:"setName",value:function(e,t,n){var i,s=_.cloneDeep(null===(i=this.props.editElement)||void 0===i?void 0:i.settings),a=null==s?void 0:s.name;if(0!=e.length){var r=_.find(t,(function(t){return t.value==e})).label;if(void 0!==a){a=a.split(this.state.delimer);var o=-1;n.length>0&&(o=_.findIndex(a,(function(e){return e==n}))),-1!==o?a[o]=r:a.push(r),a=(a=(a=_.uniq(a)).filter((function(e){return 0!==e.length}))).join(this.parseHtmlEntities(this.state.delimer))}else a=e}else if(void 0!==a){a=a.split(this.state.delimer);var l=-1;n.length>0&&(l=_.findIndex(a,(function(e){return e==n}))),-1!==l&&delete a[l],a=(a=(a=_.uniq(a)).filter((function(e){return void 0!==e&&0!==e.length}))).join(this.parseHtmlEntities(this.state.delimer))}return a}},{key:"setType",value:function(e){var t=this.state.settings;if(t=Bt(Bt({},t),{},{type:e}),this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:{settings:t}})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"generateName",value:function(e){var t=_.cloneDeep(this.state.settings),n=null==t?void 0:t.name,i=e.map((function(e){var t;return null!==(t=e.title)&&void 0!==t?t:""}));return null==n||0===n.length?n=i.join(this.state.delimer):Array.isArray(n)?(i.forEach((function(e,t){-1===_.findIndex(n,e)&&(n[t]=e)})),n=n.join(this.state.delimer)):(n=n.split(this.state.delimer),i.forEach((function(e,t){-1===_.findIndex(n,e)&&(n[t]=e)})),n=n.join(this.state.delimer)),n}},{key:"setDatasource",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.state.settings,i="",s=[];if(null===e)n=Bt(Bt({},n),{},{sources:[],params:[]}),s=[];else if(0===e.length)n=Bt(Bt({},n),{},{sources:[],params:[]}),s=[];else{var a;i=this.generateName(_.cloneDeep(e)),n=Bt(Bt({},n),{},{sources:e,params:t?[]:void 0!==(null===(a=n)||void 0===a?void 0:a.params)?(0,Z.Z)(n.params):[],name:i})}if(this.setState((function(e){return Bt(Bt({},e),{},{settings:n})})),this.props.addItemPreview){var r={settings:Bt({},n)};this.props.editElementDispatch(r),this.setState((function(e){return Bt(Bt({},e),{},{editElement:{settings:n}})}))}else{var o=this.props.editElement;o.settings.sources=s,this.props.editElementDispatch(o),this.props.editHandler(this.props.editElement.i,n)}}},{key:"parseHtmlEntities",value:function(e){return e.replace(/&#([0-9]{1,3});/gi,(function(e,t){var n=parseInt(t,10);return String.fromCharCode(n)}))}},{key:"setParam",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=this.state.settings,r=(0,a.Z)({},e,t);n.length>0&&(s.name=this.setName(t,n,i));var o=_.findKey(s.params,e);if(void 0!==o?s.params[o]=r:s=Bt(Bt({},s),{},{params:[].concat((0,Z.Z)(s.params),[r])}),s.params=s.params.filter((function(e){var t=_.keys(e)[0];return null!==s.params[t]})),this.setState((function(e){return Bt(Bt({},e),{},{settings:s})})),this.props.addItemPreview){var l={settings:Bt({},s)};this.props.editElementDispatch(l),this.setState((function(e){return Bt(Bt({},e),{},{editElement:s})}))}else{var c=this.props.editElement;c.settings=s,this.props.editElementDispatch(c),this.props.editHandler(this.props.editElement.i,s)}}},{key:"setXAxisScale",value:function(e){var t;if(t=Bt(Bt({},this.state.settings),{},"time"===e?{xScale:{type:e,format:"%d.%m.%Y",precision:"day"}}:{xScale:{type:e}}),this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:t})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"setXAxisTimeScale",value:function(e){var t=Bt(Bt({},this.state.settings),{},{xScale:Bt(Bt({},this.state.settings.xScale),{},{precision:e,format:"%d.%m.%Y"})});if(this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:t})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"setYAxisScale",value:function(e){var t=Bt(Bt({},this.state.settings),{},{yScale:{type:e}});if(this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:t})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"setColorScheme",value:function(e){var t=this.state.settings;if(t=Bt(Bt({},this.state.settings),{},{colors:{scheme:e}}),this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:t})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"setTickRotation",value:function(e){var t=Bt(Bt({},this.state.settings),{},{axisBottom:Bt(Bt({},null==t?void 0:t.axisBottom),{},{tickRotation:e})});if(this.setState((function(e){return Bt(Bt({},e),{},{settings:t})})),this.props.addItemPreview){var n={settings:Bt({},t)};this.props.editElementDispatch(n),this.setState((function(e){return Bt(Bt({},e),{},{editElement:t})}))}else{var i=this.props.editElement;i.settings=t,this.props.editElementDispatch(i),this.props.editHandler(this.props.editElement.i,t)}}},{key:"setProperty",value:function(e,t){var n=Bt(Bt({},this.state.settings),{},(0,a.Z)({},t,e));if(this.setState((function(e){return Bt(Bt({},e),{},{settings:n})})),this.props.addItemPreview){var i={settings:Bt({},n)};this.props.editElementDispatch(i),this.setState((function(e){return Bt(Bt({},e),{},{editElement:n})}))}else{var s=this.props.editElement;s.settings=n,this.props.editElementDispatch(s),this.props.editHandler(this.props.editElement.i,n)}}},{key:"render",value:function(){var e,t,n,i,s,a,r,o,l,c,d,u=this;return p.createElement("div",{className:"col ".concat(this.props.widgetID," altrp-dashboard__drawer--font")},p.createElement("div",{className:"row"},p.createElement("div",{className:"mx-auto"},p.createElement("h3",null,"Настройка диаграммы"))),p.createElement("div",{className:"row"},p.createElement(Ie.Z,{className:"collapse-button",onClick:function(){return u.setOpenDataSettings(!u.state.openDataSettings)},"aria-controls":"Datasource settings","aria-expanded":this.state.openDataSettings},p.createElement("div",{className:"collapse-button-content"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--section-font-size altrp-dashboard__drawer--font altrp-dashboard__drawer--font-margin")},"Базовые настройки"),p.createElement("div",null,this.state.openDataSettings?p.createElement(Ce.Z,null):p.createElement(je.Z,null)))),p.createElement(Le.Z,{in:this.state.openDataSettings},p.createElement("div",{style:{width:"100%"}},p.createElement(bt,{widgetID:this.props.widgetID,setType:this.setType}),p.createElement(Be,{widgetID:this.props.widgetID,datasources:this.state.datasources,setCardName:this.setCardName,setDatasource:this.setDatasource}),void 0!==this.state.filter_datasource&&_.keys(this.state.filter_datasource).length>0&&p.createElement(p.Fragment,null,p.createElement("div",{className:"col mb-3"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--label-font-size")},"Параметры")),this.state.filter_datasource.map((function(e,t){return p.createElement(ft,{widgetID:u.props.widgetID,setParam:u.setParam,key:t,setCardName:u.setCardName,param:e})}))),((null===(e=this.props.editElement)||void 0===e||null===(t=e.settings)||void 0===t?void 0:t.type)===E.fq||(null===(n=this.props.editElement)||void 0===n||null===(i=n.settings)||void 0===i?void 0:i.type)===E.e_)&&p.createElement(p.Fragment,null,p.createElement(Je,{widgetID:this.props.widgetID,setXAxisScale:this.setXAxisScale,setXAxisTimeScale:this.setXAxisTimeScale,setYAxisScale:this.setYAxisScale})),p.createElement(qt,{widgetID:this.props.widgetID,setProperty:this.setProperty})))),p.createElement("div",{className:"row"},p.createElement(Ie.Z,{className:"collapse-button",onClick:function(){return u.setOpenDiagramSettings(!u.state.openDiagramSettings)},"aria-controls":"Datasource settings","aria-expanded":this.state.openDiagramSettings},p.createElement("div",{className:"collapse-button-content"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--section-font-size altrp-dashboard__drawer--font altrp-dashboard__drawer--font-margin")},"Настройки стилей"),p.createElement("div",null,this.state.openDiagramSettings?p.createElement(Ce.Z,null):p.createElement(je.Z,null)))),p.createElement(Le.Z,{in:this.state.openDiagramSettings},p.createElement("div",null,p.createElement(pt,{widgetID:this.props.widgetID,setProperty:this.setProperty,checkboxColor:null===(s=this.props)||void 0===s?void 0:s.checkboxColor,setColorScheme:this.setColorScheme,setTickRotation:this.setTickRotation})))),p.createElement("div",{className:"row"},p.createElement(Ie.Z,{className:"collapse-button",onClick:function(){return u.setOpenTooltipSettings(!u.state.openTooltipSettings)},"aria-controls":"Datasource settings","aria-expanded":this.state.openTooltipSettings},p.createElement("div",{className:"collapse-button-content"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--section-font-size altrp-dashboard__drawer--font altrp-dashboard__drawer--font-margin")},"Настройки подсказок"),p.createElement("div",null,this.state.openTooltipSettings?p.createElement(Ce.Z,null):p.createElement(je.Z,null)))),p.createElement(Le.Z,{in:this.state.openTooltipSettings},p.createElement("div",null,p.createElement(Pt,{widgetID:this.props.widgetID,setProperty:this.setProperty})))),p.createElement("div",{className:"row"},p.createElement(Ie.Z,{className:"collapse-button",onClick:function(){return u.setOpenLegendSettings(!u.state.openLegendSettings)},"aria-controls":"Datasource settings","aria-expanded":this.state.openLegendSettings},p.createElement("div",{className:"collapse-button-content"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--section-font-size altrp-dashboard__drawer--font altrp-dashboard__drawer--font-margin")},"Настройки легенды"),p.createElement("div",null,this.state.openLegendSettings?p.createElement(Ce.Z,null):p.createElement(je.Z,null)))),p.createElement(Le.Z,{in:this.state.openLegendSettings},p.createElement("div",null,p.createElement(Ot,{widgetID:this.props.widgetID,setProperty:this.setProperty})))),((null===(a=this.state.editElement)||void 0===a||null===(r=a.settings)||void 0===r?void 0:r.type)===E.fq||(null===(o=this.state.editElement)||void 0===o||null===(l=o.settings)||void 0===l?void 0:l.type)===E.e_||(null===(c=this.state.editElement)||void 0===c||null===(d=c.settings)||void 0===d?void 0:d.type)===E.u3)&&p.createElement("div",{className:"row"},p.createElement(Ie.Z,{className:"collapse-button",onClick:function(){return u.setOpenAnimationSettings(!u.state.openAnimationSettings)},"aria-controls":"Datasource settings","aria-expanded":this.state.openAnimationSettings},p.createElement("div",{className:"collapse-button-content"},p.createElement("div",{className:"".concat(this.props.widgetID," altrp-dashboard__drawer--section-font-size altrp-dashboard__drawer--font altrp-dashboard__drawer--font-margin")},"Настройки анимации"),p.createElement("div",null,this.state.openAnimationSettings?p.createElement(Ce.Z,null):p.createElement(je.Z,null)))),p.createElement(Le.Z,{in:this.state.openAnimationSettings},p.createElement("div",null,p.createElement(jt,{widgetID:this.props.widgetID,setProperty:this.setProperty})))),this.props.addItemPreview?p.createElement("div",{className:"row justify-content-beetwen mt-3"},p.createElement("div",{className:"col"},p.createElement("button",{className:"".concat(this.props.widgetID," altrp-btn-draw"),style:{width:"100%"},onClick:function(e){return u.props.onAddItem(u.state.editElement)}},"Сохранить")),p.createElement("div",{className:"col"},p.createElement("button",{className:"".concat(this.props.widgetID," altrp-btn-draw"),style:{width:"100%"},onClick:function(e){return u.props.onCloseHandler(null,!1)}},"Отмена"))):p.createElement("div",{className:"row justify-content-beetwen mt-3"},p.createElement("div",{className:"col"},p.createElement("button",{className:"".concat(this.props.widgetID," altrp-btn-draw"),style:{width:"100%"},onClick:function(e){return u.props.onCloseHandler(null)}},"Сохранить"))))}}]),s}(p.Component);const Yt=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement)}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))}}}))(Ft);const Ht=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){return(0,r.Z)(this,s),i.call(this,e)}return(0,o.Z)(s,[{key:"render",value:function(){return p.createElement("button",{className:"altrp-btn-draw",style:{margin:"5px 5px 5px 5px"},onClick:this.props.onAddItem},"Добавить виджет")}}]),s}(p.Component);const Vt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){return(0,r.Z)(this,s),i.call(this,e)}return(0,o.Z)(s,[{key:"render",value:function(){return p.createElement("div",{className:this.props.className,style:{display:"inline-block"}},p.createElement("button",{className:"altrp-btn-draw",style:{margin:"5px 5px 5px 5px"},onClick:this.props.onExport},"Экспорт диаграмм"))}}]),s}(p.Component);const Mt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){return(0,r.Z)(this,s),i.call(this,e)}return(0,o.Z)(s,[{key:"render",value:function(){var e=this;return p.createElement("div",{className:this.props.className,style:{display:"inline-block"}},p.createElement("button",{className:"altrp-btn-draw",style:{margin:"5px 5px 5px 5px"},onClick:this.props.onImport},"Импорт диаграмм"),p.createElement("input",{type:"file",onChange:function(t){return e.props.getFile(t)},accept:"application/json"}))}}]),s}(p.Component);const Xt=function(e){(0,c.Z)(s,e);var t,n,i=(t=s,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function s(e){return(0,r.Z)(this,s),i.call(this,e)}return(0,o.Z)(s,[{key:"render",value:function(){var e=this;return p.createElement("div",{className:this.props.className,style:{display:"inline-block"}},p.createElement("button",{style:{margin:"5px 5px 5px 5px"},onClick:this.props.onImport},"Импорт виджета"),p.createElement("input",{type:"file",onChange:function(t){return e.props.getFile(t)},accept:"application/json"}))}}]),s}(p.Component);function Jt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function Gt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Jt(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ut=(0,h.WidthProvider)(h.Responsive),$t=function(e){(0,c.Z)(m,e);var t,n,h=(t=m,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,i=(0,u.Z)(t);if(n){var s=(0,u.Z)(this).constructor;e=Reflect.construct(i,arguments,s)}else e=i.apply(this,arguments);return(0,d.Z)(this,e)});function m(e){var t;return(0,r.Z)(this,m),(t=h.call(this,e)).state={id:e.id,items:e.items||[],newCounter:e.counter||1,repeater:_.cloneDeep(e.rep,[]),settingsOpen:!1,addItemPreview:!1,settings:e.settings,drawer:null,datasources:null,delimer:e.delimer,importData:[],importWidget:[]},t.export=t.export.bind((0,l.Z)(t)),t.import=t.import.bind((0,l.Z)(t)),t.getFile=t.getFile.bind((0,l.Z)(t)),t.exportCard=t.exportCard.bind((0,l.Z)(t)),t.importDiagram=t.importDiagram.bind((0,l.Z)(t)),t.getWidgetFile=t.getWidgetFile.bind((0,l.Z)(t)),t.onAddItem=t.onAddItem.bind((0,l.Z)(t)),t.onAddItemCard=t.onAddItemCard.bind((0,l.Z)(t)),t.onBreakpointChange=t.onBreakpointChange.bind((0,l.Z)(t)),t.onEditItem=t.onEditItem.bind((0,l.Z)(t)),t.onResizeHandler=t.onResizeHandler.bind((0,l.Z)(t)),t.onResizeHandlerStop=t.onResizeHandlerStop.bind((0,l.Z)(t)),t.saveWidgetData=t.saveWidgetData.bind((0,l.Z)(t)),t.onRemoveItem=t.onRemoveItem.bind((0,l.Z)(t)),t.setEditItem=t.setEditItem.bind((0,l.Z)(t)),t.openSettings=t.openSettings.bind((0,l.Z)(t)),t.setCardName=t.setCardName.bind((0,l.Z)(t)),t.onDragStop=t.onDragStop.bind((0,l.Z)(t)),t.copyWidget=t.copyWidget.bind((0,l.Z)(t)),t}return(0,o.Z)(m,[{key:"componentDidUpdate",value:function(e,t){var n=this;_.isEqual(e.items,this.props.items)||this.setState((function(e){return Gt(Gt({},e),{},{items:n.props.items})})),_.isEqual(e.counter,this.props.counter)||this.setState((function(e){return Gt(Gt({},e),{},{newCounter:n.props.counter})})),_.isEqual(t.items,this.state.items)||(this.saveWidgetData(this.state),this.setState((function(e){return Gt(Gt({},e),{},{items:n.state.items})})));var i=document.querySelector(".drawer");_.isEqual(this.state.drawer,i)||this.setState((function(e){return Gt(Gt({},e),{},{drawer:i})}))}},{key:"saveWidgetData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state,t=e.id,n=e.items,i=e.newCounter,s={items:n,newCounter:i};try{b().post("/ajax/dashboards/datasource/".concat(t,"/settings"),{settings:s},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then((function(e){console.log(e.data)}))}catch(e){console.log("ERROR ==>",e)}}},{key:"putLayoutToLocalStorage",value:function(e){}},{key:"setEditItem",value:function(e){var t=this.state.items;_.replace(t,{i:e.i},e);var n=_.findKey(t,{i:e.i});this.setState((function(i){return i.items[n]=e,Gt(Gt({},i),{},{items:t})}))}},{key:"setCardName",value:function(e,t){var n=this.state.items,i=_.find(n,{i:t.i});i.settings.name=e;var s=_.findKey(n,{i:t.i});this.setState((function(e){return e.items[s]=i,Gt(Gt({},e),{},{items:n})})),this.saveWidgetData(this.state)}},{key:"openSettings",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=_.cloneDeep(t);this.setState((function(s){return null===t&&(s.drawer=null),e.props.editElementDispatch(i),s.editElement=i,Gt(Gt({},s),{},null!==n?{settingsOpen:!s.settingsOpen,addItemPreview:n}:{settingsOpen:!s.settingsOpen})}))}},{key:"onEditItem",value:function(e,t){var n=this,i=this.state.items,s=_.find(i,{i:e});s.settings=t,s.edit=!1,this.props.editElementDispatch(s),_.replace(i,{i:e},s);var a=_.findKey(i,{i:e});this.setState((function(e){return e.items[a]=s,n.saveWidgetData(e),Gt(Gt({},e),{},{items:i})}))}},{key:"onAddItem",value:function(){this.setState((function(e){return Gt(Gt({},e),{},{addItemPreview:!0})})),this.openSettings()}},{key:"onAddItemCard",value:function(e){var t=this;_.keys(e).length>0?this.setState((function(n){Array.isArray(n.items)||(n.items=Object.values(n.items));var i=n.items.concat(t.itemSettingsAdd(n,e.settings));return Gt(Gt({},n),{},{items:i,newCounter:n.newCounter+1,addItemPreview:!1,settingsOpen:!1})})):alert("Информация не заполнена")}},{key:"itemSettingsAdd",value:function(e,t){return{i:void 0!==e.items?"n"+e.newCounter:"n0",x:void 0!==e.items?3*e.items.length%(e.cols||12):0%(e.cols||12),y:1/0,w:3,h:5,settings:t}}},{key:"onResizeHandler",value:function(e,t,n,i){var a=this;("object"===(0,s.Z)(n)?[n]:n).forEach((function(e){var t=e.i,n=e.x,i=e.y,s=e.w,r=e.h,o=_.find(a.state.items,{i:t});o=Gt(Gt({},o),{},{x:n,y:i,w:s,h:r,settings:Gt({},o.settings)});var l=_.findKey(a.state.items,{i:t});a.setState((function(e){return e.items[l]=o,Gt(Gt({},e),{},{items:e.items})}))}))}},{key:"onResizeHandlerStop",value:function(e,t,n,i){var s=n.i,r=n.x,o=n.y,l=n.w,c=n.h,d=_.find(this.state.items,{i:s}),u=_.findKey(this.state.items,{i:s});d=Gt(Gt({},d),{},{x:r,y:o,w:l,h:c}),this.setState((function(e){return Gt(Gt({},e),{},{items:Gt(Gt({},e.items),{},(0,a.Z)({},u,d))})})),this.saveWidgetData(this.state)}},{key:"onBreakpointChange",value:function(e,t){this.setState({breakpoint:e,cols:t})}},{key:"onLayoutChange",value:function(e){this.props.onLayoutChange(e)}},{key:"onDragStop",value:function(e,t,n,i,s,r){var o=n.i,l=n.x,c=n.y,d=n.w,u=n.h,p=_.find(this.state.items,{i:o}),h=_.findKey(this.state.items,{i:o});p=Gt(Gt({},p),{},{x:l,y:c,w:d,h:u}),this.setState((function(e){return Gt(Gt({},e),{},{items:Gt(Gt({},e.items),{},(0,a.Z)({},h,p))})})),this.saveWidgetData(this.state)}},{key:"onRemoveItem",value:function(e){this.state.items=_.reject(this.state.items,{i:e}),this.setState({items:this.state.items}),this.saveWidgetData(this.state)}},{key:"export",value:function(){var e={newCounter:_.cloneDeep(this.state.newCounter),items:_.cloneDeep(this.state.items)},t="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(e)),n=document.createElement("a");n.setAttribute("href",t),n.setAttribute("download","".concat(this.state.id,".json")),n.click()}},{key:"exportCard",value:function(e){var t=e.settings,n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(t)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download","".concat(e.settings.name,".json")),i.click()}},{key:"import",value:function(){var e=this,t=this.state.importData,n=this.state.id;if(_.keys(t).length<=0)alert("Выберите файл");else try{b().post("/ajax/dashboards/datasource/".concat(n,"/settings"),{settings:t},{headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}}).then((function(t){try{var n=null===JSON||void 0===JSON?void 0:JSON.parse(t.data.settings),i=n.items,s=n.newCounter;e.setState((function(e){return Gt(Gt({},e),{},{items:i,newCounter:s})}))}catch(e){}}))}catch(e){console.log("ERROR ==>",e)}}},{key:"importDiagram",value:function(){var e={settings:this.state.importWidget};if(_.keys(e.settings).length<=0)alert("Выберите файл");else try{this.onAddItemCard(e),this.setState((function(e){return{importWidget:[]}}))}catch(e){console.log("ERROR ==>",e)}}},{key:"getFile",value:function(e){var t=this,n=new FileReader;n.readAsText(e.target.files[0],"UTF-8"),n.onload=function(e){var n=JSON.parse(e.target.result);t.setState((function(e){return Gt(Gt({},e),{},{importData:n})}))}}},{key:"getWidgetFile",value:function(e){var t=this,n=new FileReader;n.readAsText(e.target.files[0],"UTF-8"),n.onload=function(e){var n=JSON.parse(e.target.result);t.setState((function(e){return Gt(Gt({},e),{},{importWidget:n})}))}}},{key:"copyWidget",value:function(e){this.onAddItemCard(e)}},{key:"createElement",value:function(e,t){return e.y=null==e.y?1/0:e.y,p.createElement("div",{key:e.i,"data-grid":e},p.createElement(Ze,{editElement:_.cloneDeep(e,{}),settings:e.settings,openSettingsHandler:this.openSettings,setEditItem:this.setEditItem,onRemoveItem:this.onRemoveItem,saveWidget:this.saveWidgetData,copyWidget:this.copyWidget,exportCard:this.exportCard,widgetID:this.state.id}))}},{key:"render",value:function(){var e,t,n=this;return p.createElement("div",null,this.props.showButton&&p.createElement(p.Fragment,null,p.createElement(Ht,{onAddItem:this.onAddItem})),this.props.showExportButton&&p.createElement(Vt,{className:"altrp-dashboars__export-dashboard-button",onExport:this.export}),p.createElement(Mt,{className:"altrp-dashboars__import-dashboard-button",onImport:this.import,getFile:this.getFile}),p.createElement(Xt,{className:"altrp-dashboars__import-diagram-button",onImport:this.importDiagram,getFile:this.getWidgetFile}),p.createElement(Ut,(0,i.Z)({draggableCancel:".altrp-dashboards__cancle-drag",onLayoutChange:this.onLayoutChange,onResizeStart:this.onResizeHandler,onResizeStop:this.onResizeHandlerStop,autoSize:!0,onDrop:this.onDrop,onDragStop:this.onDragStop,onBreakpointChange:this.onBreakpointChange},this.props),_.map(this.state.items,(function(e,t){return n.createElement(e,t)}))),p.createElement(y.Z,(t={getContainer:document.body,placement:"right",open:!0,defaultOpen:!0,width:this.props.drawerWidth},(0,a.Z)(t,"open",this.state.settingsOpen),(0,a.Z)(t,"onClose",this.openSettings),(0,a.Z)(t,"handler",!1),t),this.state.settingsOpen&&p.createElement(Yt,{widgetID:this.state.id,addItemPreview:this.state.addItemPreview,filter_datasource:this.state.settings.filter_datasource,datasources:this.props.rep,editHandler:this.onEditItem,checkboxColor:null===(e=this.state.settings)||void 0===e?void 0:e.checkboxColor,onCloseHandler:this.openSettings,onAddItem:this.onAddItemCard,setCardName:this.setCardName,delimer:this.state.delimer})),null!=this.state.drawer&&ReactDOM.createPortal(p.createElement(Re,{width:this.props.drawerWidth,widgetID:this.state.id,addItemPreview:this.state.addItemPreview,setCardName:this.setCardName}),this.state.drawer))}}]),m}(p.Component);$t.defaultProps={className:"layout",cols:{lg:12,md:10,sm:6,xs:4,xxs:2},rowHeight:60,onLayoutChange:function(){}};const Kt=(0,m.$j)((function(e){return{editElement:_.cloneDeep(e.editElement),dashboardExport:_.cloneDeep(e.exportDashboard)}}),(function(e){return{editElementDispatch:function(t){return e((0,v.Y)(t))},exportDashboardDispatch:function(t){return e((0,f.o)(t))}}}),null,{forwardRef:!0})($t)}}]);